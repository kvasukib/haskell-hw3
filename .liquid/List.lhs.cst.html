<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>List.lhs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
Lists
=====


<div class="hidden">
\begin{code}
<pre><span class=hs-linenum> 7: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 8: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 9: </span>
<span class=hs-linenum>10: </span><span class='hs-comment'>-- CHECKBINDER prop_size</span>
<span class=hs-linenum>11: </span><span class='hs-comment'>-- CHECKBINDER empty</span>
<span class=hs-linenum>12: </span><span class='hs-comment'>-- CHECKBINDER add</span>
<span class=hs-linenum>13: </span><span class='hs-comment'>-- CHECKBINDER singleton</span>
<span class=hs-linenum>14: </span><span class='hs-comment'>-- CHECKBINDER prop_replicate</span>
<span class=hs-linenum>15: </span><span class='hs-comment'>-- CHECKBINDER prop_map</span>
<span class=hs-linenum>16: </span><span class='hs-comment'>-- CHECKBINDER foldr1</span>
<span class=hs-linenum>17: </span><span class='hs-comment'>-- CHECKBINDER prop_zipWith</span>
<span class=hs-linenum>18: </span><span class='hs-comment'>-- CHECKBINDER prop_concat</span>
<span class=hs-linenum>19: </span>
<span class=hs-linenum>20: </span>
<span class=hs-linenum>21: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span> <span class='hs-conid'>List</span>
<span class=hs-linenum>22: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>empty</span>
<span class=hs-linenum>23: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>add</span>
<span class=hs-linenum>24: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>singleton</span>
<span class=hs-linenum>25: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>map</span>
<span class=hs-linenum>26: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>replicate</span>
<span class=hs-linenum>27: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>foldr</span>
<span class=hs-linenum>28: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>foldr1</span>
<span class=hs-linenum>29: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>zipWith</span>
<span class=hs-linenum>30: </span>            <span class='hs-layout'>,</span> <span class='hs-varid'>concat</span>
<span class=hs-linenum>31: </span>            <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>32: </span>
<span class=hs-linenum>33: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Assert</span>
<span class=hs-linenum>34: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span><span class='hs-layout'>,</span> <span class='hs-varid'>replicate</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldr</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldr1</span><span class='hs-layout'>,</span> <span class='hs-varid'>map</span><span class='hs-layout'>,</span> <span class='hs-varid'>concat</span><span class='hs-layout'>,</span> <span class='hs-varid'>zipWith</span><span class='hs-layout'>)</span>
<span class=hs-linenum>35: </span>
<span class=hs-linenum>36: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>9</span> <span class='hs-conop'>:+:</span>
<span class=hs-linenum>37: </span>
<span class=hs-linenum>38: </span><span class='hs-definition'>empty</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>39: </span><span class='hs-definition'>add</span>       <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>40: </span><span class='hs-definition'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>41: </span><span class='hs-definition'>replicate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>42: </span><span class='hs-definition'>map</span>       <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>43: </span><span class='hs-definition'>zipWith</span>   <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>44: </span><span class='hs-definition'>concat</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
</pre>\end{code}

A Sized List Datatype
---------------------

Lets cook up our own `List` data type from scratch:

\begin{code}
<pre><span class=hs-linenum>53: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span>
<span class=hs-linenum>54: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-conop'>:+:</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>55: </span>              <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Eq a) =&gt; (Eq (List a))</span><span class='hs-conid'>Eq</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Eq (List a), Ord a) =&gt; (Ord (List a))</span><span class='hs-conid'>Ord</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Show a) =&gt; (Show (List a))</span><span class='hs-conid'>Show</span></a><span class='hs-layout'>)</span>
</pre>\end{code}

We can write a **measure** that logically represents
the *size*, i.e. number of elements of a `List`:

\begin{code}
<pre><span class=hs-linenum>62: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>size</span>      <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>63: </span>    <span class='hs-varid'>size</span> <span class='hs-layout'>(</span><span class='hs-conid'>Emp</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class=hs-linenum>64: </span>    <span class='hs-varid'>size</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conop'>:+:</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>size</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>65: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>66: </span>
<span class=hs-linenum>67: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>invariant</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| 0 &lt;= size v}</span> <span class='hs-keyword'>@-}</span>
</pre>\end{code}

It will be helpful to have a few abbreviations. First,
lists whose size is equal to `N`

\begin{code}
<pre><span class=hs-linenum>74: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
</pre>\end{code}
and then, lists whose size equals that of *another* list `Xs`:

\begin{code}
<pre><span class=hs-linenum>79: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>size</span> <span class='hs-conid'>Xs</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
</pre>\end{code}

(a) Computing the Length of a List
----------------------------------

Write down a *refined* type for `length`:
\begin{code}
<pre><span class=hs-linenum>87: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>length</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span> <span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>Nat</span> <span class='hs-keyword'>| v == size xs}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>88: </span><span class='hs-definition'>length</span>            <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>89: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1645:(List a) -&gt; {v##16 : Int | v##16 &gt;= 0
                                          &amp;&amp; v##16 == size lq_tmp$x##1645}</span><span class='hs-definition'>length</span></a> <span class='hs-conid'>Emp</span>        <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class=hs-linenum>90: </span><span class='hs-definition'>length</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1676 : Int | lq_tmp$x##1676 == (1 : int)}</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##1695:Int -&gt; lq_tmp$x##1696:Int -&gt; {lq_tmp$x##1698 : Int^"lq_tmp$x##1697" | lq_tmp$x##1698 == lq_tmp$x##1695 + lq_tmp$x##1696}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1682 : Int | lq_tmp$x##1682 &gt;= 0
                        &amp;&amp; lq_tmp$x##1682 == size xs##a1uG}</span><span class='hs-varid'>length</span></a> <span class='hs-varid'>xs</span>
</pre>\end{code}

such that the following type checks:

\begin{code}
<pre><span class=hs-linenum>96: </span>
<span class=hs-linenum>97: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>98: </span><a class=annot href="#"><span class=annottext>{v##4 : Bool | Prop v##4}</span><span class='hs-definition'>prop_size</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1739 : lq_tmp$x##1740:{lq_tmp$x##1737 : Bool | Prop lq_tmp$x##1737} -&gt; {lq_tmp$x##1738 : Bool | Prop lq_tmp$x##1738} | lq_tmp$x##1739 == Assert.lAssert##rlA}</span><span class='hs-varid'>lAssert</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1704 : Int | lq_tmp$x##1704 &gt;= 0
                        &amp;&amp; lq_tmp$x##1704 == size List.l3##rXs}</span><span class='hs-varid'>length</span></a> <span class='hs-varid'>l3</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1726:{lq_tmp$x##1731 : Int^"lq_tmp$x##1730" | $k_$35$$35$1729[VV$35$$35$1728:=lq_tmp$36$x$35$$35$1731][lq_tmp$36$x$35$$35$1725:=GHC.Classes.$36$fEqInt$35$$35$roe]} -&gt; lq_tmp$x##1727:{lq_tmp$x##1731 : Int^"lq_tmp$x##1730" | $k_$35$$35$1729[VV$35$$35$1728:=lq_tmp$36$x$35$$35$1731][lq_tmp$36$x$35$$35$1725:=GHC.Classes.$36$fEqInt$35$$35$roe]} -&gt; {lq_tmp$x##1721 : Bool | Prop lq_tmp$x##1721 &lt;=&gt; lq_tmp$x##1726 == lq_tmp$x##1727}</span><span class='hs-varop'>==</span></a> <span class='hs-num'>3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>99: </span>
<span class=hs-linenum>100: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>l3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Int</span> <span class='hs-num'>3</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>101: </span><a class=annot href="#"><span class=annottext>{v##2 : (List Int) | size v##2 == 3}</span><span class='hs-definition'>l3</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-num'>3</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>l2</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>l2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Int</span> <span class='hs-num'>2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>104: </span><a class=annot href="#"><span class=annottext>{v##2 : (List Int) | size v##2 == 2}</span><span class='hs-definition'>l2</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-num'>2</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>l1</span>
<span class=hs-linenum>105: </span>
<span class=hs-linenum>106: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>l1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Int</span> <span class='hs-num'>1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>107: </span><a class=annot href="#"><span class=annottext>{v##2 : (List Int) | size v##2 == 1}</span><span class='hs-definition'>l1</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>l0</span>
<span class=hs-linenum>108: </span>
<span class=hs-linenum>109: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>l0</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Int</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>110: </span><a class=annot href="#"><span class=annottext>{v##2 : (List Int) | size v##2 == 0}</span><span class='hs-definition'>l0</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-conid'>Int</span>
</pre>\end{code}


(b) Constructing Lists
----------------------

Fill in the implementations of the following functions so that
LiquidHaskell verifies respect the given type signatures:

\begin{code}
<pre><span class=hs-linenum>121: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>empty</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>122: </span><a class=annot href="#"><span class=annottext>{v##2 : (List a) | size v##2 == 0}</span><span class='hs-definition'>empty</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span>
<span class=hs-linenum>123: </span>
<span class=hs-linenum>124: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>add</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{1 + size xs}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>125: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1479:a -&gt; lq_tmp$x##1480:(List a) -&gt; {v##2 : (List a) | size v##2 == 1 + size lq_tmp$x##1480}</span><span class='hs-definition'>add</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(List a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>126: </span>
<span class=hs-linenum>127: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>singleton</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-num'>1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>128: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1461:a -&gt; {v##2 : (List a) | size v##2 == 1}</span><span class='hs-definition'>singleton</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-conid'>Emp</span>
</pre>\end{code}

(c) Replicating Values
----------------------

Fill in the code, and update the refinement type specification
for `replicate n x` which should return a `List` `n` copies of
the value `x`:

\begin{code}
<pre><span class=hs-linenum>139: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>replicate</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>140: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1499:Int -&gt; lq_tmp$x##1500:a -&gt; {v##2 : (List a) | size v##2 == lq_tmp$x##1499}</span><span class='hs-definition'>replicate</span></a> <span class='hs-num'>0</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>empty</span>
<span class=hs-linenum>141: </span><span class='hs-definition'>replicate</span> <span class='hs-varid'>n</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1567:(List {VV##1568 : a^"lq_tmp$x##1570" | $k_$35$$35$1569[lq_tmp$36$x$35$$35$1566:=ds_d1Ga]}) -&gt; {lq_tmp$x##1563 : (List {VV##1568 : a^"lq_tmp$x##1570" | $k_$35$$35$1569[lq_tmp$36$x$35$$35$1566:=ds_d1Ga]}) | size lq_tmp$x##1563 == 1 + size lq_tmp$x##1567}</span><span class='hs-varid'>add</span></a> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1499:Int -&gt; lq_tmp$x##1500:a -&gt; {v##2 : (List a) | size v##2 == lq_tmp$x##1499}</span><span class='hs-varid'>replicate</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1545 : Int^"lq_tmp$x##1544" | lq_tmp$x##1545 == ds_d1G9 - lq_anf$##d1HA}</span><span class='hs-varid'>n</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##1542:Int -&gt; lq_tmp$x##1543:Int -&gt; {lq_tmp$x##1545 : Int^"lq_tmp$x##1544" | lq_tmp$x##1545 == lq_tmp$x##1542 - lq_tmp$x##1543}</span><span class='hs-comment'>-</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
</pre>\end{code}

When you are done, the following assertion should be verified by LH.

\begin{code}
<pre><span class=hs-linenum>147: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_replicate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>148: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1743:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##1744:a -&gt; {v##4 : Bool | Prop v##4}</span><span class='hs-definition'>prop_replicate</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1786 : lq_tmp$x##1787:{lq_tmp$x##1784 : Bool | Prop lq_tmp$x##1784} -&gt; {lq_tmp$x##1785 : Bool | Prop lq_tmp$x##1785} | lq_tmp$x##1786 == Assert.lAssert##rlA}</span><span class='hs-varid'>lAssert</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1768 : Bool | Prop lq_tmp$x##1768 &lt;=&gt; n##a1uM == lq_anf$##d1HN}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##1773:{lq_tmp$x##1778 : Int^"lq_tmp$x##1777" | $k_$35$$35$1776[lq_tmp$36$x$35$$35$1772:=GHC.Classes.$36$fEqInt$35$$35$roe][VV$35$$35$1775:=lq_tmp$36$x$35$$35$1778]} -&gt; lq_tmp$x##1774:{lq_tmp$x##1778 : Int^"lq_tmp$x##1777" | $k_$35$$35$1776[lq_tmp$36$x$35$$35$1772:=GHC.Classes.$36$fEqInt$35$$35$roe][VV$35$$35$1775:=lq_tmp$36$x$35$$35$1778]} -&gt; {lq_tmp$x##1768 : Bool | Prop lq_tmp$x##1768 &lt;=&gt; lq_tmp$x##1773 == lq_tmp$x##1774}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1759 : Int | lq_tmp$x##1759 &gt;= 0
                        &amp;&amp; lq_tmp$x##1759 == size lq_anf$##d1HM}</span><span class='hs-varid'>length</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1499:Int -&gt; lq_tmp$x##1500:a -&gt; {v##2 : (List a) | size v##2 == lq_tmp$x##1499}</span><span class='hs-varid'>replicate</span></a> <span class='hs-varid'>n</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
</pre>\end{code}

(d) Map
-------

Fix the specification for `map` such that the assertion in `prop_map`
is verified by LH. (This will require you to first complete part (a) above.)

\begin{code}
<pre><span class=hs-linenum>158: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>map</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>as</span> <span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>as</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>159: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1399:(lq_tmp$x##1398:a -&gt; b) -&gt; lq_tmp$x##1400:(List a) -&gt; {v##3 : (List b) | size v##3 == size lq_tmp$x##1400}</span><span class='hs-definition'>map</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##1398:a -&gt; b</span><span class='hs-varid'>f</span></a> <span class='hs-conid'>Emp</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span>
<span class=hs-linenum>160: </span><span class='hs-definition'>map</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1430 : lq_tmp$x##1431:a -&gt; b | lq_tmp$x##1430 == f##a1uO}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1399:(lq_tmp$x##1398:a -&gt; b) -&gt; lq_tmp$x##1400:(List a) -&gt; {v##3 : (List b) | size v##3 == size lq_tmp$x##1400}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1447 : lq_tmp$x##1448:a -&gt; b | lq_tmp$x##1447 == f##a1uO}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum>161: </span>
<span class=hs-linenum>162: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_map</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>163: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1791:(lq_tmp$x##1790:a -&gt; a) -&gt; lq_tmp$x##1792:(List a) -&gt; {v##4 : Bool | Prop v##4}</span><span class='hs-definition'>prop_map</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##1790:a -&gt; a</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>(List a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1850 : lq_tmp$x##1851:{lq_tmp$x##1848 : Bool | Prop lq_tmp$x##1848} -&gt; {lq_tmp$x##1849 : Bool | Prop lq_tmp$x##1849} | lq_tmp$x##1850 == Assert.lAssert##rlA}</span><span class='hs-varid'>lAssert</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1796 : Int | lq_tmp$x##1796 &gt;= 0
                        &amp;&amp; lq_tmp$x##1796 == size xs##a1uT}</span><span class='hs-varid'>length</span></a> <span class='hs-varid'>xs</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1837:{lq_tmp$x##1842 : Int^"lq_tmp$x##1841" | $k_$35$$35$1840[lq_tmp$36$x$35$$35$1836:=GHC.Classes.$36$fEqInt$35$$35$roe][VV$35$$35$1839:=lq_tmp$36$x$35$$35$1842]} -&gt; lq_tmp$x##1838:{lq_tmp$x##1842 : Int^"lq_tmp$x##1841" | $k_$35$$35$1840[lq_tmp$36$x$35$$35$1836:=GHC.Classes.$36$fEqInt$35$$35$roe][VV$35$$35$1839:=lq_tmp$36$x$35$$35$1842]} -&gt; {lq_tmp$x##1832 : Bool | Prop lq_tmp$x##1832 &lt;=&gt; lq_tmp$x##1837 == lq_tmp$x##1838}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1823 : Int | lq_tmp$x##1823 &gt;= 0
                        &amp;&amp; lq_tmp$x##1823 == size lq_anf$##d1HQ}</span><span class='hs-varid'>length</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1399:(lq_tmp$x##1398:a -&gt; b) -&gt; lq_tmp$x##1400:(List a) -&gt; {v##3 : (List b) | size v##3 == size lq_tmp$x##1400}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1818 : lq_tmp$x##1819:a -&gt; a | lq_tmp$x##1818 == f##a1uS}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
</pre>\end{code}

(e) Fold
--------

Fix the specification for `foldr1` so that the call to `die` is
verified by LH:

\begin{code}
<pre><span class=hs-linenum>173: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>foldr1</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{as :</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size as &gt; 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>174: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1325:(lq_tmp$x##1323:a -&gt; lq_tmp$x##1324:a -&gt; a) -&gt; lq_tmp$x##1326:{as##19 : (List a) | size as##19 &gt; 0} -&gt; a</span><span class='hs-definition'>foldr1</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##1323:a -&gt; lq_tmp$x##1324:a -&gt; a</span><span class='hs-varid'>op</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1267:(lq_tmp$x##1265:a -&gt; lq_tmp$x##1266:b -&gt; b) -&gt; lq_tmp$x##1268:b -&gt; lq_tmp$x##1269:(List a) -&gt; b</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1393 : lq_tmp$x##1394:a -&gt; lq_tmp$x##1395:a -&gt; a | lq_tmp$x##1393 == op##a1uU}</span><span class='hs-varid'>op</span></a> <span class='hs-varid'>x</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum>175: </span><span class='hs-definition'>foldr1</span> <span class='hs-varid'>op</span> <span class='hs-conid'>Emp</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1352:{lq_tmp$x##1350 : [Char] | false} -&gt; t</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1342 : [Char] | lq_tmp$x##1342 ~~ lq_anf$##d1Hs
                           &amp;&amp; len lq_tmp$x##1342 == strLen lq_anf$##d1Hs}</span><span class='hs-str'>"Cannot call foldr1 with empty list"</span></a>
<span class=hs-linenum>176: </span>
<span class=hs-linenum>177: </span><span class='hs-definition'>foldr</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>178: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1267:(lq_tmp$x##1265:a -&gt; lq_tmp$x##1266:b -&gt; b) -&gt; lq_tmp$x##1268:b -&gt; lq_tmp$x##1269:(List a) -&gt; b</span><span class='hs-definition'>foldr</span></a> <span class='hs-keyword'>_</span>  <a class=annot href="#"><span class=annottext>b</span><span class='hs-varid'>b</span></a> <span class='hs-conid'>Emp</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>179: </span><span class='hs-definition'>foldr</span> <span class='hs-varid'>op</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a^"lq_tmp$x##593" | VV == x##a1v1}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1320 : lq_tmp$x##1321:a -&gt; lq_tmp$x##1322:b -&gt; b | lq_tmp$x##1320 == ds_d1G5}</span><span class='hs-varop'>`op`</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1267:(lq_tmp$x##1265:a -&gt; lq_tmp$x##1266:b -&gt; b) -&gt; lq_tmp$x##1268:b -&gt; lq_tmp$x##1269:(List a) -&gt; b</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1314 : lq_tmp$x##1315:a -&gt; lq_tmp$x##1316:b -&gt; b | lq_tmp$x##1314 == ds_d1G5}</span><span class='hs-varid'>op</span></a> <span class='hs-varid'>b</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
</pre>\end{code}

(f) ZipWith
-----------

Fix the specification of `zipWith` so that LH verifies:

+ The call to `die` inside `zipWith` and
+ The assert inside `prop_zipwith`.

\begin{code}
<pre><span class=hs-linenum>191: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>zipWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>as</span> <span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>as</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>c</span> <span class='hs-keyword'>as</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>192: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1088:(lq_tmp$x##1086:a -&gt; lq_tmp$x##1087:b -&gt; c) -&gt; lq_tmp$x##1089:(List a) -&gt; lq_tmp$x##1090:{v##3 : (List b) | size v##3 == size lq_tmp$x##1089} -&gt; {v##3 : (List c) | size v##3 == size lq_tmp$x##1089}</span><span class='hs-definition'>zipWith</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>Emp</span> <span class='hs-conid'>Emp</span>               <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span>
<span class=hs-linenum>193: </span><span class='hs-definition'>zipWith</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1222 : lq_tmp$x##1223:a -&gt; lq_tmp$x##1224:b -&gt; c | lq_tmp$x##1222 == ds_d1G0}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-conop'>:+:</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1088:(lq_tmp$x##1086:a -&gt; lq_tmp$x##1087:b -&gt; c) -&gt; lq_tmp$x##1089:(List a) -&gt; lq_tmp$x##1090:{v##3 : (List b) | size v##3 == size lq_tmp$x##1089} -&gt; {v##3 : (List c) | size v##3 == size lq_tmp$x##1089}</span><span class='hs-varid'>zipWith</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1249 : lq_tmp$x##1250:a -&gt; lq_tmp$x##1251:b -&gt; c | lq_tmp$x##1249 == ds_d1G0}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>xs</span> <span class='hs-varid'>ys</span>
<span class=hs-linenum>194: </span><span class='hs-definition'>zipWith</span> <span class='hs-varid'>f</span> <span class='hs-keyword'>_</span>          <span class='hs-keyword'>_</span>          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1194:{lq_tmp$x##1192 : [Char] | false} -&gt; t</span><span class='hs-varid'>die</span></a>  <a class=annot href="#"><span class=annottext>{lq_tmp$x##1184 : [Char] | lq_tmp$x##1184 ~~ lq_anf$##d1Hl
                           &amp;&amp; len lq_tmp$x##1184 == strLen lq_anf$##d1Hl}</span><span class='hs-str'>"Bad call to zipWith"</span></a>
<span class=hs-linenum>195: </span>
<span class=hs-linenum>196: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_zipWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>197: </span><a class=annot href="#"><span class=annottext>(Num a) =&gt; lq_tmp$x##1855:(List a) -&gt; {v##4 : Bool | Prop v##4}</span><span class='hs-definition'>prop_zipWith</span></a> <a class=annot href="#"><span class=annottext>(List a)</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1934 : lq_tmp$x##1935:{lq_tmp$x##1932 : Bool | Prop lq_tmp$x##1932} -&gt; {lq_tmp$x##1933 : Bool | Prop lq_tmp$x##1933} | lq_tmp$x##1934 == Assert.lAssert##rlA}</span><span class='hs-varid'>lAssert</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1898 : Int | lq_tmp$x##1898 &gt;= 0
                        &amp;&amp; lq_tmp$x##1898 == size xs##a1v9}</span><span class='hs-varid'>length</span></a> <span class='hs-varid'>xs</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1921:{lq_tmp$x##1926 : Int^"lq_tmp$x##1925" | $k_$35$$35$1924[lq_tmp$36$x$35$$35$1920:=GHC.Classes.$36$fEqInt$35$$35$roe][VV$35$$35$1923:=lq_tmp$36$x$35$$35$1926]} -&gt; lq_tmp$x##1922:{lq_tmp$x##1926 : Int^"lq_tmp$x##1925" | $k_$35$$35$1924[lq_tmp$36$x$35$$35$1920:=GHC.Classes.$36$fEqInt$35$$35$roe][VV$35$$35$1923:=lq_tmp$36$x$35$$35$1926]} -&gt; {lq_tmp$x##1916 : Bool | Prop lq_tmp$x##1916 &lt;=&gt; lq_tmp$x##1921 == lq_tmp$x##1922}</span><span class='hs-varop'>==</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1907 : Int | lq_tmp$x##1907 &gt;= 0
                        &amp;&amp; lq_tmp$x##1907 == size x2s##a1va}</span><span class='hs-varid'>length</span></a> <span class='hs-varid'>x2s</span><span class='hs-layout'>)</span>
<span class=hs-linenum>198: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>199: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##1872 : (List {VV##1887 : a^"lq_tmp$x##1889" | $k_$35$$35$1888[lq_tmp$36$x$35$$35$1880:=xs$35$$35$a1v9][lq_tmp$36$x$35$$35$1878:=lq_anf$36$$35$$35$d1HT][lq_tmp$36$x$35$$35$1879:=xs$35$$35$a1v9]}) | size lq_tmp$x##1872 == size xs##a1v9}</span><span class='hs-varid'>x2s</span></a>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1088:(lq_tmp$x##1086:a -&gt; lq_tmp$x##1087:b -&gt; c) -&gt; lq_tmp$x##1089:(List a) -&gt; lq_tmp$x##1090:{v##3 : (List b) | size v##3 == size lq_tmp$x##1089} -&gt; {v##3 : (List c) | size v##3 == size lq_tmp$x##1089}</span><span class='hs-varid'>zipWith</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##1863:a -&gt; lq_tmp$x##1864:a -&gt; {VV : a^"lq_tmp$x##1865" | VV == lq_tmp$x##1863 + lq_tmp$x##1864}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>xs</span>
</pre>\end{code}

(g) List Concatenation *(Hard?)*
--------------------------------

Fill in the (refinement type) specification and
implementation for the function `concat` such that
when you are done, the assert inside `prop_concat`
is verified by LH. Feel free to write any other code
or specification (types, measures) that you need.

\begin{code}
<pre><span class=hs-linenum>212: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>append</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>as</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>bs</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span>  <span class='hs-keyword'>{cs:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span>  <span class='hs-keyword'>| size cs == ((size as) + (size bs))}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>213: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##980:(List a) -&gt; lq_tmp$x##981:(List a) -&gt; {cs##26 : (List a) | size cs##26 == size lq_tmp$x##980 + size lq_tmp$x##981}</span><span class='hs-definition'>append</span></a> <span class='hs-conid'>Emp</span>        <a class=annot href="#"><span class=annottext>(List a)</span><span class='hs-varid'>bs</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bs</span>
<span class=hs-linenum>214: </span><span class='hs-definition'>append</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-conop'>:+:</span> <span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-varid'>bs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span> <span class='hs-conop'>:+:</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1010 : (List {VV##1015 : a^"lq_tmp$x##1017" | $k_$35$$35$1016[lq_tmp$36$x$35$$35$1014:=bs$35$$35$a1vb][lq_tmp$36$x$35$$35$1013:=as$35$$35$a1vd]}) | size lq_tmp$x##1010 == size as##a1vd + size bs##a1vb}</span><span class='hs-keyword'>as</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##980:(List a) -&gt; lq_tmp$x##981:(List a) -&gt; {cs##26 : (List a) | size cs##26 == size lq_tmp$x##980 + size lq_tmp$x##981}</span><span class='hs-varop'>`append`</span></a> <span class='hs-varid'>bs</span><span class='hs-layout'>)</span>
<span class=hs-linenum>215: </span>
<span class=hs-linenum>216: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>sizeN</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>217: </span>    <span class='hs-varid'>sizeN</span> <span class='hs-conid'>Emp</span>          <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class=hs-linenum>218: </span>    <span class='hs-varid'>sizeN</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-conop'>:+:</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>size</span> <span class='hs-varid'>a</span> <span class='hs-varop'>+</span> <span class='hs-varid'>sizeN</span> <span class='hs-keyword'>as</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>219: </span>
<span class=hs-linenum>220: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>concat</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>as</span> <span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>sizeN</span> <span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>221: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1031:(List (List a)) -&gt; {v##2 : (List a) | size v##2 == sizeN lq_tmp$x##1031}</span><span class='hs-definition'>concat</span></a>        <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span>
<span class=hs-linenum>222: </span><span class='hs-definition'>concat</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-conop'>:+:</span> <span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##980:(List a) -&gt; lq_tmp$x##981:(List a) -&gt; {cs##26 : (List a) | size cs##26 == size lq_tmp$x##980 + size lq_tmp$x##981}</span><span class='hs-varid'>a</span></a> <span class='hs-varop'>`append`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1065 : (List {VV##1068 : a^"lq_tmp$x##1070" | $k_$35$$35$1069[lq_tmp$36$x$35$$35$1067:=as$35$$35$a1vg]}) | size lq_tmp$x##1065 == sizeN as##a1vg}</span><span class='hs-varid'>concat</span></a> <span class='hs-keyword'>as</span>
<span class=hs-linenum>223: </span>
<span class=hs-linenum>224: </span><a class=annot href="#"><span class=annottext>{VV##1938 : Bool^"lq_tmp$x##1940" | $k_$35$$35$1939}</span><span class='hs-definition'>prop_concat</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2080 : lq_tmp$x##2081:{lq_tmp$x##2078 : Bool | Prop lq_tmp$x##2078} -&gt; {lq_tmp$x##2079 : Bool | Prop lq_tmp$x##2079} | lq_tmp$x##2080 == Assert.lAssert##rlA}</span><span class='hs-varid'>lAssert</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2045 : Int | lq_tmp$x##2045 &gt;= 0
                        &amp;&amp; lq_tmp$x##2045 == size lq_anf$##d1I1}</span><span class='hs-varid'>length</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2033 : (List {lq_tmp$x##2039 : Int^"lq_tmp$x##2038" | $k_$35$$35$2037[VV$35$$35$2036:=lq_tmp$36$x$35$$35$2039][lq_tmp$36$x$35$$35$2035:=xss$35$$35$a1vh]}) | size lq_tmp$x##2033 == sizeN xss##a1vh}</span><span class='hs-varid'>concat</span></a> <span class='hs-varid'>xss</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2067:{lq_tmp$x##2072 : Int^"lq_tmp$x##2071" | $k_$35$$35$2070[lq_tmp$36$x$35$$35$2066:=GHC.Classes.$36$fEqInt$35$$35$roe][VV$35$$35$2069:=lq_tmp$36$x$35$$35$2072]} -&gt; lq_tmp$x##2068:{lq_tmp$x##2072 : Int^"lq_tmp$x##2071" | $k_$35$$35$2070[lq_tmp$36$x$35$$35$2066:=GHC.Classes.$36$fEqInt$35$$35$roe][VV$35$$35$2069:=lq_tmp$36$x$35$$35$2072]} -&gt; {lq_tmp$x##2062 : Bool | Prop lq_tmp$x##2062 &lt;=&gt; lq_tmp$x##2067 == lq_tmp$x##2068}</span><span class='hs-varop'>==</span></a> <span class='hs-num'>6</span><span class='hs-layout'>)</span>
<span class=hs-linenum>225: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>226: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##2012 : (List {lq_tmp$x##2024 : (List {lq_tmp$x##2023 : Int^"lq_tmp$x##2019" | $k_$35$$35$2018[VV$35$$35$2017:=lq_tmp$36$x$35$$35$2023][lq_tmp$36$x$35$$35$2016:=lq_anf$36$$35$$35$d1I0][lq_tmp$36$x$35$$35$2015:=List.l0$35$$35$rXv][VV$35$$35$2020:=lq_tmp$36$x$35$$35$2024]})^"lq_tmp$x##2022" | $k_$35$$35$2021[lq_tmp$36$x$35$$35$2016:=lq_anf$36$$35$$35$d1I0][lq_tmp$36$x$35$$35$2015:=List.l0$35$$35$rXv][VV$35$$35$2020:=lq_tmp$36$x$35$$35$2024]}) | sizeN lq_tmp$x##2012 == size List.l0##rXv + sizeN lq_anf$##d1I0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                         &amp;&amp; size lq_tmp$x##2012 == 1 + size lq_anf$##d1I0}</span><span class='hs-varid'>xss</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>l0</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>l1</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>l2</span> <span class='hs-conop'>:+:</span> <span class='hs-varid'>l3</span> <span class='hs-conop'>:+:</span> <span class='hs-conid'>Emp</span>
</pre>\end{code}

</body>
</html>