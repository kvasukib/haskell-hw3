<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>KMeans.lhs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
K-Means Clustering
==================


<div class="hidden">
\begin{code}
<pre><span class=hs-linenum> 7: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span>    <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 8: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 9: </span>
<span class=hs-linenum>10: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>KMeans</span> <span class='hs-layout'>(</span><span class='hs-varid'>kmeans</span><span class='hs-layout'>,</span> <span class='hs-varid'>kmeans1</span><span class='hs-layout'>,</span> <span class='hs-varid'>nearest</span><span class='hs-layout'>,</span> <span class='hs-varid'>mergeCluster</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>11: </span>
<span class=hs-linenum>12: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-varid'>minimumBy</span><span class='hs-layout'>)</span>
<span class=hs-linenum>13: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>MapReduce</span>
<span class=hs-linenum>14: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Assert</span>
<span class=hs-linenum>15: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>List</span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span><span class='hs-layout'>,</span> <span class='hs-varid'>repeat</span><span class='hs-layout'>,</span> <span class='hs-varid'>foldr</span><span class='hs-layout'>,</span> <span class='hs-varid'>zipWith</span><span class='hs-layout'>)</span>
<span class=hs-linenum>17: </span><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>M</span>
<span class=hs-linenum>18: </span>
<span class=hs-linenum>19: </span><span class='hs-definition'>centroid</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span>
<span class=hs-linenum>20: </span><span class='hs-definition'>distance</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>21: </span><span class='hs-definition'>nearest</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Center</span>
<span class=hs-linenum>22: </span><span class='hs-definition'>mergeCluster</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cluster</span>
<span class=hs-linenum>23: </span><span class='hs-definition'>kmeans1</span>   <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span>
<span class=hs-linenum>24: </span><span class='hs-definition'>kmeans</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-conid'>Point</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Centering</span>
</pre>\end{code}
</div>

Next, lets use our `MapReduce` library to implement
[K-Means Clustering](http://en.wikipedia.org/wiki/K-means_clustering)


Points and Clusters
-------------------

First, lets define the various types that model the key entities in clustering.


\begin{code}
<pre><span class=hs-linenum>39: </span><span class='hs-comment'>-- | N-Dimensional Point</span>
<span class=hs-linenum>40: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Point</span>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>List</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>41: </span>
<span class=hs-linenum>42: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>PointN</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>Double</span> <span class='hs-conid'>N</span> <span class='hs-keyword'>@-}</span>
</pre>\end{code}

**A Center** is a number between `0` and `k` (written `CenterK k`).

\begin{code}
<pre><span class=hs-linenum>48: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Center</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>49: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>CenterK</span> <span class='hs-conid'>K</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>|</span> <span class='hs-num'>0</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&lt;</span> <span class='hs-conid'>K</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
</pre>\end{code}

**A Centering** is a map from `Center`s to `Point`s. Our clustering algorithm
will aim to group a (large) set of `Point`s into `k` representatives. Thus, a
*k-n-Centering* is a map from `CenterK k` to `PointN n`:

\begin{code}
<pre><span class=hs-linenum>57: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Centering</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-conid'>Center</span> <span class='hs-conid'>Point</span>
<span class=hs-linenum>58: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-conid'>K</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-layout'>(</span><span class='hs-conid'>CenterK</span> <span class='hs-conid'>K</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>PointN</span> <span class='hs-conid'>N</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
</pre>\end{code}

**A Cluster** is a pair of a *number* of points (denoting the cluster size)
and the *co-ordinates* denoting the (sum of) the co-ordinates of all the points
in the cluster. We represent `n`-dimensional clusters as `ClusterN n`;  note that
the cluster size is *strictly positive* as we will never represent empty clusters.

\begin{code}
<pre><span class=hs-linenum>67: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-conid'>Point</span><span class='hs-layout'>)</span>
<span class=hs-linenum>68: </span>
<span class=hs-linenum>69: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ClusterN</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>Pos</span><span class='hs-layout'>,</span> <span class='hs-conid'>PointN</span> <span class='hs-conid'>N</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>70: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos</span>        <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
</pre>\end{code}

(a) Computing Euclidean Distance
--------------------------------

If you did the `zipWith` problem, then you should see an error in
the implementation of `distance` which computes the
[Euclidean Distance](http://en.wikipedia.org/wiki/Euclidean_distance)
between two points. Fix the **specification** (not the code) of `distance` so
that the code is verified by LH:

\begin{code}
<pre><span class=hs-linenum>83: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>distance</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>84: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1134:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##1135:{v##2 : (List Double) | size v##2 == lq_tmp$x##1134} -&gt; lq_tmp$x##1136:{v##2 : (List Double) | size v##2 == lq_tmp$x##1134} -&gt; Double</span><span class='hs-definition'>distance</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{v##2 : (List Double) | size v##2 == n##a2kA}</span><span class='hs-varid'>px</span></a> <a class=annot href="#"><span class=annottext>{v##2 : (List Double) | size v##2 == n##a2kA}</span><span class='hs-varid'>py</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1144:Double -&gt; Double</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1177:{lq_tmp$x##1186 : Double^"lq_tmp$x##1185" "lq_tmp$x##132" | $k_$35$$35$1184[VV$35$$35$1183:=lq_tmp$36$x$35$$35$1186][lq_tmp$36$x$35$$35$1176:=lq_anf$36$$35$$35$d2rC]} -&gt; lq_tmp$x##1178:(List {lq_tmp$x##1182 : Double^"lq_tmp$x##1181" "lq_tmp$x##134" | $k_$35$$35$1180[VV$35$$35$1179:=lq_tmp$36$x$35$$35$1182][lq_tmp$36$x$35$$35$1176:=lq_anf$36$$35$$35$d2rC]}) -&gt; {lq_tmp$x##1186 : Double^"lq_tmp$x##1185" "lq_tmp$x##136" | $k_$35$$35$1184[VV$35$$35$1183:=lq_tmp$36$x$35$$35$1186][lq_tmp$36$x$35$$35$1176:=lq_anf$36$$35$$35$d2rC]}</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##1155:Double -&gt; lq_tmp$x##1156:Double -&gt; {lq_tmp$x##1158 : Double^"lq_tmp$x##1157" | lq_tmp$x##1158 == lq_tmp$x##1155 + lq_tmp$x##1156}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1163 : Double | lq_tmp$x##1163 == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>x##a2kD:{VV##1196 : Double^"lq_tmp$x##1198" | $k_$35$$35$1197} -&gt; y##a2kE:{VV##1200 : Double^"lq_tmp$x##1202" | $k_$35$$35$1201} -&gt; {VV##1204 : Double^"lq_tmp$x##1206" | $k_$35$$35$1205}</span><span class='hs-varid'>zipWith</span></a> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV##1196 : Double^"lq_tmp$x##1198" | $k_$35$$35$1197}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV##1200 : Double^"lq_tmp$x##1202" | $k_$35$$35$1201}</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>Double</span><span class='hs-varid'>x</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##1217:Double -&gt; lq_tmp$x##1218:Integer -&gt; Double</span><span class='hs-varop'>^</span></a><span class='hs-num'>2</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1258:Double -&gt; lq_tmp$x##1259:Double -&gt; {lq_tmp$x##1261 : Double^"lq_tmp$x##1260" | lq_tmp$x##1261 == lq_tmp$x##1258 - lq_tmp$x##1259}</span><span class='hs-comment'>-</span></a> <a class=annot href="#"><span class=annottext>Double</span><span class='hs-varid'>y</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##1240:Double -&gt; lq_tmp$x##1241:Integer -&gt; Double</span><span class='hs-varop'>^</span></a><span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>px</span> <span class='hs-varid'>py</span>
</pre>\end{code}

(b) Map Points To Nearest Center
--------------------------------

Use `distance` to fill in the **implementation** of `nearest`
so that LH verifies the given type signature.

\begin{code}
<pre><span class=hs-linenum>94: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>nearest</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenterK</span> <span class='hs-varid'>k</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>95: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1350:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##1351:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##1352:(Map {v##0 : Int | 0 &lt;= v##0
                                                                                                                            &amp;&amp; v##0 &lt; lq_tmp$x##1350} {v##2 : (List Double) | size v##2 == lq_tmp$x##1351}) -&gt; lq_tmp$x##1353:{v##2 : (List Double) | size v##2 == lq_tmp$x##1351} -&gt; {v##0 : Int | 0 &lt;= v##0
                                                                                                                                                                                                                                                                                                    &amp;&amp; v##0 &lt; lq_tmp$x##1350}</span><span class='hs-definition'>nearest</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(Map {v##0 : Int | 0 &lt;= v##0
                   &amp;&amp; v##0 &lt; k##a2kF} {v##2 : (List Double) | size v##2 == n##a2kG})</span><span class='hs-varid'>centers</span></a> <a class=annot href="#"><span class=annottext>{v##2 : (List Double) | size v##2 == n##a2kG}</span><span class='hs-varid'>p</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1363:{lq_tmp$x##1359 : (Map {lq_tmp$x##1367 : Int^"lq_tmp$x##1366" "lq_tmp$x##978" | $k_$35$$35$1365[VV$35$$35$1364:=lq_tmp$36$x$35$$35$1367][lq_tmp$36$x$35$$35$1362:=GHC.Classes.$36$fOrdDouble$35$$35$ren]
                                                                                               &amp;&amp; $k_$35$$35$977[VV$35$$35$982:=lq_tmp$36$x$35$$35$1359][fix$36$$36$dOrd_a2n0:=GHC.Classes.$36$fOrdDouble$35$$35$ren][VV$35$$35$976:=lq_tmp$36$x$35$$35$1367][lq_tmp$36$x$35$$35$1362:=GHC.Classes.$36$fOrdDouble$35$$35$ren]} {lq_tmp$x##1371 : Double^"lq_tmp$x##1370" "lq_tmp$x##981" | $k_$35$$35$1369[lq_tmp$36$x$35$$35$1362:=GHC.Classes.$36$fOrdDouble$35$$35$ren][VV$35$$35$1368:=lq_tmp$36$x$35$$35$1371]
                                                                                                                                                                                                                                                                                                                                                                                           &amp;&amp; $k_$35$$35$980[VV$35$$35$982:=lq_tmp$36$x$35$$35$1359][fix$36$$36$dOrd_a2n0:=GHC.Classes.$36$fOrdDouble$35$$35$ren][VV$35$$35$979:=lq_tmp$36$x$35$$35$1371][lq_tmp$36$x$35$$35$1362:=GHC.Classes.$36$fOrdDouble$35$$35$ren]})^"lq_tmp$x##984" | $k_$35$$35$983[VV$35$$35$982:=lq_tmp$36$x$35$$35$1359][fix$36$$36$dOrd_a2n0:=GHC.Classes.$36$fOrdDouble$35$$35$ren][lq_tmp$36$x$35$$35$1362:=GHC.Classes.$36$fOrdDouble$35$$35$ren]} -&gt; {lq_tmp$x##1367 : Int^"lq_tmp$x##1366" "lq_tmp$x##987" | $k_$35$$35$1365[VV$35$$35$1364:=lq_tmp$36$x$35$$35$1367][lq_tmp$36$x$35$$35$1362:=GHC.Classes.$36$fOrdDouble$35$$35$ren]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &amp;&amp; $k_$35$$35$986[fix$36$$36$dOrd_a2n0:=GHC.Classes.$36$fOrdDouble$35$$35$ren][lq_tmp$36$x$35$$35$1362:=GHC.Classes.$36$fOrdDouble$35$$35$ren][VV$35$$35$985:=lq_tmp$36$x$35$$35$1367][lq_tmp$36$x$35$$35$975:=lq_tmp$36$x$35$$35$1363]}</span><span class='hs-varid'>minKeyMap</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>x##a2kJ:{VV##1378 : (List {VV##1375 : Double^"lq_tmp$x##1377" | $k_$35$$35$1376})^"lq_tmp$x##1380" | $k_$35$$35$1379} -&gt; Double</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV##1378 : (List {VV##1375 : Double^"lq_tmp$x##1377" | $k_$35$$35$1376})^"lq_tmp$x##1380" | $k_$35$$35$1379}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1390 : lq_tmp$x##1391:{lq_tmp$x##1382 : Int | lq_tmp$x##1382 &gt;= 0} -&gt; lq_tmp$x##1392:{lq_tmp$x##1384 : (List Double) | size lq_tmp$x##1384 == lq_tmp$x##1391} -&gt; lq_tmp$x##1393:{lq_tmp$x##1386 : (List Double) | size lq_tmp$x##1386 == lq_tmp$x##1391} -&gt; Double | lq_tmp$x##1390 == KMeans.distance##r1KX}</span><span class='hs-varid'>distance</span></a> <span class='hs-varid'>n</span> <span class='hs-varid'>p</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>centers</span>
</pre>\end{code}

You may want to use the helper `minKeyMap` that computes the key
with the smallest value in a `Map`:

\begin{code}
<pre><span class=hs-linenum>102: </span><span class='hs-comment'>--- &gt;&gt;&gt; minKeyMap (M.fromList [(0, 12), (1, 23), (2, 7), (3,18)])</span>
<span class=hs-linenum>103: </span><span class='hs-comment'>--- 2</span>
<span class=hs-linenum>104: </span><span class='hs-definition'>minKeyMap</span>  <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span>
<span class=hs-linenum>105: </span><a class=annot href="#"><span class=annottext>(Ord v) =&gt;
lq_tmp$x##975:{VV##982 : (Map {VV##976 : k^"lq_tmp$x##978" | $k_$35$$35$977} {VV##979 : v^"lq_tmp$x##981" | $k_$35$$35$980})^"lq_tmp$x##984" | $k_$35$$35$983} -&gt; {VV##985 : k^"lq_tmp$x##987" | $k_$35$$35$986}</span><span class='hs-definition'>minKeyMap</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##998:{lq_tmp$x##994 : [{lq_tmp$x##990 : ({VV##999 : k^"lq_tmp$x##1001" "lq_tmp$x##779" | $k_$35$$35$1000[lq_tmp$36$x$35$$35$997:=fix$36$$36$dOrd_a2n0]
                                                                                                  &amp;&amp; $k_$35$$35$778[fix$36$$36$dOrd_a2mF:=fix$36$$36$dOrd_a2n0][VV$35$$35$777:=VV$35$$35$999][VV$35$$35$804:=lq_tmp$36$x$35$$35$994][VV$35$$35$787:=lq_tmp$36$x$35$$35$990][lq_tmp$36$x$35$$35$997:=fix$36$$36$dOrd_a2n0]}, {VV##1002 : v^"lq_tmp$x##1004" "lq_tmp$x##782" | $k_$35$$35$1003[lq_tmp$36$x$35$$35$997:=fix$36$$36$dOrd_a2n0]
                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; $k_$35$$35$781[VV$35$$35$780:=VV$35$$35$1002][fix$36$$36$dOrd_a2mF:=fix$36$$36$dOrd_a2n0][VV$35$$35$804:=lq_tmp$36$x$35$$35$994][VV$35$$35$787:=lq_tmp$36$x$35$$35$990][lq_tmp$36$x$35$$35$997:=fix$36$$36$dOrd_a2n0]})^"lq_tmp$x##789" | $k_$35$$35$788[fix$36$$36$dOrd_a2mF:=fix$36$$36$dOrd_a2n0][VV$35$$35$804:=lq_tmp$36$x$35$$35$994][VV$35$$35$787:=lq_tmp$36$x$35$$35$990][lq_tmp$36$x$35$$35$997:=fix$36$$36$dOrd_a2n0]}]^"lq_tmp$x##806" | $k_$35$$35$805[fix$36$$36$dOrd_a2mF:=fix$36$$36$dOrd_a2n0][VV$35$$35$804:=lq_tmp$36$x$35$$35$994][lq_tmp$36$x$35$$35$997:=fix$36$$36$dOrd_a2n0]} -&gt; {VV##999 : k^"lq_tmp$x##1001" "lq_tmp$x##810" | $k_$35$$35$1000[lq_tmp$36$x$35$$35$997:=fix$36$$36$dOrd_a2n0]
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         &amp;&amp; $k_$35$$35$809[fix$36$$36$dOrd_a2mF:=fix$36$$36$dOrd_a2n0][xs$35$$35$a2kK:=lq_tmp$36$x$35$$35$998][VV$35$$35$808:=VV$35$$35$999][lq_tmp$36$x$35$$35$997:=fix$36$$36$dOrd_a2n0]}</span><span class='hs-varid'>minKeyList</span></a> <span class='hs-varop'>.</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-varid'>toList</span>
<span class=hs-linenum>106: </span>
<span class=hs-linenum>107: </span><span class='hs-definition'>minKeyList</span>    <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>k</span><span class='hs-layout'>,</span><span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span>
<span class=hs-linenum>108: </span><a class=annot href="#"><span class=annottext>(Ord v) =&gt;
xs##a2kK:{VV##804 : [{VV##787 : ({VV##777 : k^"lq_tmp$x##779" | $k_$35$$35$778}, {VV##780 : v^"lq_tmp$x##782" | $k_$35$$35$781})^"lq_tmp$x##789" | $k_$35$$35$788}]^"lq_tmp$x##806" | $k_$35$$35$805} -&gt; {VV##808 : k^"lq_tmp$x##810" | $k_$35$$35$809}</span><span class='hs-definition'>minKeyList</span></a> <a class=annot href="#"><span class=annottext>{VV##804 : [{VV##787 : ({VV##777 : k^"lq_tmp$x##779" | $k_$35$$35$778}, {VV##780 : v^"lq_tmp$x##782" | $k_$35$$35$781})^"lq_tmp$x##789" | $k_$35$$35$788}]^"lq_tmp$x##806" | $k_$35$$35$805}</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##814:({VV##815 : k^"lq_tmp$x##817" "lq_tmp$x##2" | $k_$35$$35$816}, {VV##818 : v^"lq_tmp$x##820" "lq_tmp$x##3" | $k_$35$$35$819}) -&gt; {VV##815 : k^"lq_tmp$x##817" "lq_tmp$x##6" | $k_$35$$35$816}</span><span class='hs-varid'>fst</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##903:(lq_tmp$x##900:{lq_tmp$x##919 : ({VV##905 : k^"lq_tmp$x##907" | $k_$35$$35$906[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]}, {VV##908 : v^"lq_tmp$x##910" | $k_$35$$35$909[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]})^"lq_tmp$x##917" "lq_tmp$x##216" | $k_$35$$35$916[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]} -&gt; lq_tmp$x##901:{lq_tmp$x##919 : ({VV##905 : k^"lq_tmp$x##907" | $k_$35$$35$906[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]}, {VV##908 : v^"lq_tmp$x##910" | $k_$35$$35$909[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]})^"lq_tmp$x##917" "lq_tmp$x##218" | $k_$35$$35$916[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]} -&gt; Ordering) -&gt; lq_tmp$x##904:[{lq_tmp$x##919 : ({VV##905 : k^"lq_tmp$x##907" | $k_$35$$35$906[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]}, {VV##908 : v^"lq_tmp$x##910" | $k_$35$$35$909[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]})^"lq_tmp$x##917" "lq_tmp$x##222" | $k_$35$$35$916[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]}] -&gt; {lq_tmp$x##919 : ({VV##905 : k^"lq_tmp$x##907" | $k_$35$$35$906[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]}, {VV##908 : v^"lq_tmp$x##910" | $k_$35$$35$909[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]})^"lq_tmp$x##917" "lq_tmp$x##223" | $k_$35$$35$916[VV$35$$35$915:=lq_tmp$36$x$35$$35$919][lq_tmp$36$x$35$$35$902:=Data.Foldable.$36$fFoldable$91$$93$$35$$35$r1Lo]}</span><span class='hs-varid'>minimumBy</span></a> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV##832 : ({VV##822 : k^"lq_tmp$x##824" | $k_$35$$35$823}, {VV##825 : v^"lq_tmp$x##827" | $k_$35$$35$826})^"lq_tmp$x##834" | $k_$35$$35$833}</span><span class='hs-varid'>x1</span></a> <a class=annot href="#"><span class=annottext>{VV##846 : ({VV##836 : k^"lq_tmp$x##838" | $k_$35$$35$837}, {VV##839 : v^"lq_tmp$x##841" | $k_$35$$35$840})^"lq_tmp$x##848" | $k_$35$$35$847}</span><span class='hs-varid'>x2</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##885:{VV##887 : v^"lq_tmp$x##889" | $k_$35$$35$888[lq_tmp$36$x$35$$35$884:=fix$36$$36$dOrd_a2mF]} -&gt; lq_tmp$x##886:{VV##887 : v^"lq_tmp$x##889" | $k_$35$$35$888[lq_tmp$36$x$35$$35$884:=fix$36$$36$dOrd_a2mF]} -&gt; {lq_tmp$x##880 : Ordering | (lq_tmp$x##880 == GHC.Types.EQ##6U &lt;=&gt; lq_tmp$x##885 == lq_tmp$x##886)
                                                                                                                                                                                                                                                        &amp;&amp; (lq_tmp$x##880 == GHC.Types.LT##6S &lt;=&gt; lq_tmp$x##885 &lt; lq_tmp$x##886)
                                                                                                                                                                                                                                                        &amp;&amp; (lq_tmp$x##880 == GHC.Types.GT##6W &lt;=&gt; lq_tmp$x##885 &gt; lq_tmp$x##886)}</span><span class='hs-varid'>compare</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##860 : v^"lq_tmp$x##862" "lq_tmp$x##12" | $k_$35$$35$861[lq_tmp$36$x$35$$35$856:=x1$35$$35$a2kL]}</span><span class='hs-varid'>snd</span></a> <span class='hs-varid'>x1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##873 : v^"lq_tmp$x##875" "lq_tmp$x##12" | $k_$35$$35$874[lq_tmp$36$x$35$$35$869:=x2$35$$35$a2kM]}</span><span class='hs-varid'>snd</span></a> <span class='hs-varid'>x2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span>
</pre>\end{code}

When you are done, you should get the following behavior:


\begin{code}
<pre><span class=hs-linenum>115: </span><span class='hs-comment'>-- &gt;&gt;&gt; test_nearest</span>
<span class=hs-linenum>116: </span><span class='hs-comment'>-- 1</span>
<span class=hs-linenum>117: </span><a class=annot href="#"><span class=annottext>{VV##1466 : Int^"lq_tmp$x##1468" | $k_$35$$35$1467}</span><span class='hs-definition'>test_nearest</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2115 : lq_tmp$x##2116:{lq_tmp$x##2103 : Int | lq_tmp$x##2103 &gt;= 0} -&gt; lq_tmp$x##2117:{lq_tmp$x##2104 : Int | lq_tmp$x##2104 &gt;= 0} -&gt; lq_tmp$x##2118:(Map {lq_tmp$x##2105 : Int | 0 &lt;= lq_tmp$x##2105
                                                                                                                                                                                            &amp;&amp; lq_tmp$x##2105 &lt; lq_tmp$x##2116} {lq_tmp$x##2107 : (List Double) | size lq_tmp$x##2107 == lq_tmp$x##2117}) -&gt; lq_tmp$x##2119:{lq_tmp$x##2110 : (List Double) | size lq_tmp$x##2110 == lq_tmp$x##2117} -&gt; {lq_tmp$x##2111 : Int | 0 &lt;= lq_tmp$x##2111
                                                                                                                                                                                                                                                                                                                                                                                                                                &amp;&amp; lq_tmp$x##2111 &lt; lq_tmp$x##2116} | lq_tmp$x##2115 == KMeans.nearest##r1KY}</span><span class='hs-varid'>nearest</span></a> <span class='hs-num'>3</span> <span class='hs-num'>2</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##2071:[({lq_tmp$x##2075 : Int^"lq_tmp$x##2074" "lq_tmp$x##178" | $k_$35$$35$2073[lq_tmp$36$x$35$$35$2070:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2072:=lq_tmp$36$x$35$$35$2075]}, {lq_tmp$x##2083 : (List {lq_tmp$x##2082 : Double^"lq_tmp$x##2078" | $k_$35$$35$2077[lq_tmp$36$x$35$$35$2070:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2079:=lq_tmp$36$x$35$$35$2083][VV$35$$35$2076:=lq_tmp$36$x$35$$35$2082]})^"lq_tmp$x##2081" "lq_tmp$x##179" | $k_$35$$35$2080[lq_tmp$36$x$35$$35$2070:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2079:=lq_tmp$36$x$35$$35$2083]})] -&gt; (Map {lq_tmp$x##2075 : Int^"lq_tmp$x##2074" "lq_tmp$x##187" | $k_$35$$35$2073[lq_tmp$36$x$35$$35$2070:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2072:=lq_tmp$36$x$35$$35$2075]} {lq_tmp$x##2083 : (List {lq_tmp$x##2082 : Double^"lq_tmp$x##2078" | $k_$35$$35$2077[lq_tmp$36$x$35$$35$2070:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2079:=lq_tmp$36$x$35$$35$2083][VV$35$$35$2076:=lq_tmp$36$x$35$$35$2082]})^"lq_tmp$x##2081" "lq_tmp$x##188" | $k_$35$$35$2080[lq_tmp$36$x$35$$35$2070:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2079:=lq_tmp$36$x$35$$35$2083]})</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>fromList</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-varid'>p0</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-num'>1</span><span class='hs-layout'>,</span> <span class='hs-varid'>p1</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-num'>2</span><span class='hs-layout'>,</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span>
<span class=hs-linenum>118: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>119: </span>    <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-varid'>p0</span><span class='hs-layout'>,</span> <span class='hs-varid'>p1</span><span class='hs-layout'>,</span> <span class='hs-varid'>p2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Point</span>
<span class=hs-linenum>120: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##1640 : (List {lq_tmp$x##1648 : Double^"lq_tmp$x##1647" | $k_$35$$35$1646[lq_tmp$36$x$35$$35$1644:=lq_anf$36$$35$$35$d2s4][lq_tmp$36$x$35$$35$1643:=lq_anf$36$$35$$35$d2s1][VV$35$$35$1645:=lq_tmp$36$x$35$$35$1648]}) | size lq_tmp$x##1640 == 1 + size lq_anf$##d2s4}</span><span class='hs-varid'>p0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1644:(List {lq_tmp$x##1648 : Double^"lq_tmp$x##1647" | $k_$35$$35$1646[lq_tmp$36$x$35$$35$1643:=lq_anf$36$$35$$35$d2s1][VV$35$$35$1645:=lq_tmp$36$x$35$$35$1648]}) -&gt; {lq_tmp$x##1640 : (List {lq_tmp$x##1648 : Double^"lq_tmp$x##1647" | $k_$35$$35$1646[lq_tmp$36$x$35$$35$1643:=lq_anf$36$$35$$35$d2s1][VV$35$$35$1645:=lq_tmp$36$x$35$$35$1648]}) | size lq_tmp$x##1640 == 1 + size lq_tmp$x##1644}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1608 : Double | lq_tmp$x##1608 == 0.0}</span><span class='hs-num'>0.0</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1630:(List {lq_tmp$x##1634 : Double^"lq_tmp$x##1633" | $k_$35$$35$1632[lq_tmp$36$x$35$$35$1629:=lq_anf$36$$35$$35$d2s2][VV$35$$35$1631:=lq_tmp$36$x$35$$35$1634]}) -&gt; {lq_tmp$x##1626 : (List {lq_tmp$x##1634 : Double^"lq_tmp$x##1633" | $k_$35$$35$1632[lq_tmp$36$x$35$$35$1629:=lq_anf$36$$35$$35$d2s2][VV$35$$35$1631:=lq_tmp$36$x$35$$35$1634]}) | size lq_tmp$x##1626 == 1 + size lq_tmp$x##1630}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1614 : Double | lq_tmp$x##1614 == 0.0}</span><span class='hs-num'>0.0</span></a> <span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum>121: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##1594 : (List {lq_tmp$x##1602 : Double^"lq_tmp$x##1601" | $k_$35$$35$1600[VV$35$$35$1599:=lq_tmp$36$x$35$$35$1602][lq_tmp$36$x$35$$35$1597:=lq_anf$36$$35$$35$d2rX][lq_tmp$36$x$35$$35$1598:=lq_anf$36$$35$$35$d2s0]}) | size lq_tmp$x##1594 == 1 + size lq_anf$##d2s0}</span><span class='hs-varid'>p1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1598:(List {lq_tmp$x##1602 : Double^"lq_tmp$x##1601" | $k_$35$$35$1600[VV$35$$35$1599:=lq_tmp$36$x$35$$35$1602][lq_tmp$36$x$35$$35$1597:=lq_anf$36$$35$$35$d2rX]}) -&gt; {lq_tmp$x##1594 : (List {lq_tmp$x##1602 : Double^"lq_tmp$x##1601" | $k_$35$$35$1600[VV$35$$35$1599:=lq_tmp$36$x$35$$35$1602][lq_tmp$36$x$35$$35$1597:=lq_anf$36$$35$$35$d2rX]}) | size lq_tmp$x##1594 == 1 + size lq_tmp$x##1598}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1562 : Double | lq_tmp$x##1562 == 3.0}</span><span class='hs-num'>3.0</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1584:(List {lq_tmp$x##1588 : Double^"lq_tmp$x##1587" | $k_$35$$35$1586[lq_tmp$36$x$35$$35$1583:=lq_anf$36$$35$$35$d2rY][VV$35$$35$1585:=lq_tmp$36$x$35$$35$1588]}) -&gt; {lq_tmp$x##1580 : (List {lq_tmp$x##1588 : Double^"lq_tmp$x##1587" | $k_$35$$35$1586[lq_tmp$36$x$35$$35$1583:=lq_anf$36$$35$$35$d2rY][VV$35$$35$1585:=lq_tmp$36$x$35$$35$1588]}) | size lq_tmp$x##1580 == 1 + size lq_tmp$x##1584}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1568 : Double | lq_tmp$x##1568 == 0.0}</span><span class='hs-num'>0.0</span></a> <span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum>122: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##1548 : (List {lq_tmp$x##1556 : Double^"lq_tmp$x##1555" | $k_$35$$35$1554[VV$35$$35$1553:=lq_tmp$36$x$35$$35$1556][lq_tmp$36$x$35$$35$1551:=lq_anf$36$$35$$35$d2rT][lq_tmp$36$x$35$$35$1552:=lq_anf$36$$35$$35$d2rW]}) | size lq_tmp$x##1548 == 1 + size lq_anf$##d2rW}</span><span class='hs-varid'>p2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1552:(List {lq_tmp$x##1556 : Double^"lq_tmp$x##1555" | $k_$35$$35$1554[VV$35$$35$1553:=lq_tmp$36$x$35$$35$1556][lq_tmp$36$x$35$$35$1551:=lq_anf$36$$35$$35$d2rT]}) -&gt; {lq_tmp$x##1548 : (List {lq_tmp$x##1556 : Double^"lq_tmp$x##1555" | $k_$35$$35$1554[VV$35$$35$1553:=lq_tmp$36$x$35$$35$1556][lq_tmp$36$x$35$$35$1551:=lq_anf$36$$35$$35$d2rT]}) | size lq_tmp$x##1548 == 1 + size lq_tmp$x##1552}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1516 : Double | lq_tmp$x##1516 == 0.0}</span><span class='hs-num'>0.0</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1538:(List {lq_tmp$x##1542 : Double^"lq_tmp$x##1541" | $k_$35$$35$1540[VV$35$$35$1539:=lq_tmp$36$x$35$$35$1542][lq_tmp$36$x$35$$35$1537:=lq_anf$36$$35$$35$d2rU]}) -&gt; {lq_tmp$x##1534 : (List {lq_tmp$x##1542 : Double^"lq_tmp$x##1541" | $k_$35$$35$1540[VV$35$$35$1539:=lq_tmp$36$x$35$$35$1542][lq_tmp$36$x$35$$35$1537:=lq_anf$36$$35$$35$d2rU]}) | size lq_tmp$x##1534 == 1 + size lq_tmp$x##1538}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1522 : Double | lq_tmp$x##1522 == 3.0}</span><span class='hs-num'>3.0</span></a> <span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
<span class=hs-linenum>123: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##1502 : (List {lq_tmp$x##1510 : Double^"lq_tmp$x##1509" | $k_$35$$35$1508[lq_tmp$36$x$35$$35$1505:=lq_anf$36$$35$$35$d2rP][VV$35$$35$1507:=lq_tmp$36$x$35$$35$1510][lq_tmp$36$x$35$$35$1506:=lq_anf$36$$35$$35$d2rS]}) | size lq_tmp$x##1502 == 1 + size lq_anf$##d2rS}</span><span class='hs-varid'>p</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1506:(List {lq_tmp$x##1510 : Double^"lq_tmp$x##1509" | $k_$35$$35$1508[lq_tmp$36$x$35$$35$1505:=lq_anf$36$$35$$35$d2rP][VV$35$$35$1507:=lq_tmp$36$x$35$$35$1510]}) -&gt; {lq_tmp$x##1502 : (List {lq_tmp$x##1510 : Double^"lq_tmp$x##1509" | $k_$35$$35$1508[lq_tmp$36$x$35$$35$1505:=lq_anf$36$$35$$35$d2rP][VV$35$$35$1507:=lq_tmp$36$x$35$$35$1510]}) | size lq_tmp$x##1502 == 1 + size lq_tmp$x##1506}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1470 : Double | lq_tmp$x##1470 == 2.9}</span><span class='hs-num'>2.9</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1492:(List {lq_tmp$x##1496 : Double^"lq_tmp$x##1495" | $k_$35$$35$1494[VV$35$$35$1493:=lq_tmp$36$x$35$$35$1496][lq_tmp$36$x$35$$35$1491:=lq_anf$36$$35$$35$d2rQ]}) -&gt; {lq_tmp$x##1488 : (List {lq_tmp$x##1496 : Double^"lq_tmp$x##1495" | $k_$35$$35$1494[VV$35$$35$1493:=lq_tmp$36$x$35$$35$1496][lq_tmp$36$x$35$$35$1491:=lq_anf$36$$35$$35$d2rQ]}) | size lq_tmp$x##1488 == 1 + size lq_tmp$x##1492}</span><span class='hs-varid'>add</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1476 : Double | lq_tmp$x##1476 == 1.1}</span><span class='hs-num'>1.1</span></a> <span class='hs-varid'>empty</span><span class='hs-layout'>)</span>
</pre>\end{code}

(c) Reduce Clusters
-------------------

Fix the **specification** below so that that LH verifies `mergeCluster`
which takes two `Cluster` and merges them by adding up their points
and centers. (Leave the code unmodified).

\begin{code}
<pre><span class=hs-linenum>134: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>mergeCluster</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ClusterN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ClusterN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ClusterN</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>135: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2129:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##2130:({v##1 : Int | v##1 &gt; 0}, {v##2 : (List Double) | size v##2 == lq_tmp$x##2129}) -&gt; lq_tmp$x##2131:({v##1 : Int | v##1 &gt; 0}, {v##2 : (List Double) | size v##2 == lq_tmp$x##2129}) -&gt; ({v##1 : Int | v##1 &gt; 0}, {v##2 : (List Double) | size v##2 == lq_tmp$x##2129})</span><span class='hs-definition'>mergeCluster</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>n</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>n1</span><span class='hs-layout'>,</span> <span class='hs-varid'>p1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>n2</span><span class='hs-layout'>,</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2201 : Int^"lq_tmp$x##2200" | lq_tmp$x##2201 == n1##a2kS + n2##a2kU}</span><span class='hs-varid'>n1</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2198:Int -&gt; lq_tmp$x##2199:Int -&gt; {lq_tmp$x##2201 : Int^"lq_tmp$x##2200" | lq_tmp$x##2201 == lq_tmp$x##2198 + lq_tmp$x##2199}</span><span class='hs-varop'>+</span></a> <span class='hs-varid'>n2</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2230:(List {lq_tmp$x##2235 : Double^"lq_tmp$x##2234" | $k_$35$$35$2233[lq_tmp$36$x$35$$35$2229:=lq_anf$36$$35$$35$d2sl][VV$35$$35$2232:=lq_tmp$36$x$35$$35$2235]}) -&gt; lq_tmp$x##2231:{lq_tmp$x##2222 : (List {lq_tmp$x##2239 : Double^"lq_tmp$x##2238" | $k_$35$$35$2237[VV$35$$35$2236:=lq_tmp$36$x$35$$35$2239][lq_tmp$36$x$35$$35$2229:=lq_anf$36$$35$$35$d2sl]}) | size lq_tmp$x##2222 == size lq_tmp$x##2230} -&gt; {lq_tmp$x##2223 : (List {lq_tmp$x##2243 : Double^"lq_tmp$x##2242" | $k_$35$$35$2241[lq_tmp$36$x$35$$35$2229:=lq_anf$36$$35$$35$d2sl][VV$35$$35$2240:=lq_tmp$36$x$35$$35$2243]}) | size lq_tmp$x##2223 == size lq_tmp$x##2230}</span><span class='hs-varid'>zipWith</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##2212:Double -&gt; lq_tmp$x##2213:Double -&gt; {lq_tmp$x##2215 : Double^"lq_tmp$x##2214" | lq_tmp$x##2215 == lq_tmp$x##2212 + lq_tmp$x##2213}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span>
</pre>\end{code}

**Note:** The code above uses `zipWith`; so you will only see the error
and be able to fix it, *after* you solve that problem.

(d) Convert Cluster into Centroid Point
---------------------------------------

The `centroid` function converts a `Cluster` into a single `Point` by
dividing each co-ordinate with the cluster size. Fix the **specification**
of `centroid` so that LH verifies the call to `divide`:

\begin{code}
<pre><span class=hs-linenum>149: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>centroid</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{i :</span> <span class='hs-conid'>Nat</span> <span class='hs-keyword'>| i &gt; 0 }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>150: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##733:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##734:{v##2 : (List Double) | size v##2 == lq_tmp$x##733} -&gt; lq_tmp$x##735:{v##16 : Int | v##16 &gt;= 0
                                                                                                                                              &amp;&amp; v##16 &gt; 0} -&gt; {v##2 : (List Double) | size v##2 == lq_tmp$x##733}</span><span class='hs-definition'>centroid</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{v##2 : (List Double) | size v##2 == n##a2kW}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0
               &amp;&amp; v##16 &gt; 0}</span><span class='hs-varid'>sz</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x##a2kZ:{VV##739 : Double^"lq_tmp$x##741" | $k_$35$$35$740} -&gt; Double</span><span class='hs-varid'>map</span></a> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>{VV##739 : Double^"lq_tmp$x##741" | $k_$35$$35$740}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>Double</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##747 : lq_tmp$x##748:Double -&gt; lq_tmp$x##749:{lq_tmp$x##744 : Int | lq_tmp$x##744 /= 0} -&gt; Double | lq_tmp$x##747 == Assert.divide##rlD}</span><span class='hs-varop'>`divide`</span></a> <span class='hs-varid'>sz</span><span class='hs-layout'>)</span> <span class='hs-varid'>p</span>
</pre>\end{code}

**Note:** The code below uses `map` from `List.lhs`; and hence
your solution will only work if you solved that problem first.


(e) Iterative Clustering
--------------------

The Kmeans clustering algorithm is shown below:



\begin{code}
<pre><span class=hs-linenum>165: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>kmeans</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>166: </span>              <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span>
<span class=hs-linenum>167: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>168: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##3038:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##3039:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##3040:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##3041:(List {v##2 : (List Double) | size v##2 == lq_tmp$x##3040}) -&gt; lq_tmp$x##3042:(Map {v##0 : Int | 0 &lt;= v##0
                                                                                                                                                                                                                                                       &amp;&amp; v##0 &lt; lq_tmp$x##3039} {v##2 : (List Double) | size v##2 == lq_tmp$x##3040}) -&gt; (Map {v##0 : Int | 0 &lt;= v##0
                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; v##0 &lt; lq_tmp$x##3039} {v##2 : (List Double) | size v##2 == lq_tmp$x##3040})</span><span class='hs-definition'>kmeans</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>steps</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(List {v##2 : (List Double) | size v##2 == n##a2l2})</span><span class='hs-varid'>ps</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2966:{VV##2949 : Int^"lq_tmp$x##2951" | $k_$35$$35$2950} -&gt; lq_tmp$x##2967:(lq_tmp$x##2965:{VV##2953 : a^"lq_tmp$x##2955" | $k_$35$$35$2954[ds_d2rm:=lq_tmp$36$x$35$$35$2966]} -&gt; {VV##2956 : a^"lq_tmp$x##2958" | $k_$35$$35$2957[ds_d2rm:=lq_tmp$36$x$35$$35$2966][lq_tmp$36$x$35$$35$2952:=lq_tmp$36$x$35$$35$2965]}) -&gt; lq_tmp$x##2968:{VV##2959 : a^"lq_tmp$x##2961" | $k_$35$$35$2960[ds_d2rm:=lq_tmp$36$x$35$$35$2966][f$35$$35$a2l4:=lq_tmp$36$x$35$$35$2967]} -&gt; {VV##2962 : a^"lq_tmp$x##2964" | $k_$35$$35$2963[ds_d2rm:=lq_tmp$36$x$35$$35$2966][x$35$$35$a2l5:=lq_tmp$36$x$35$$35$2968][f$35$$35$a2l4:=lq_tmp$36$x$35$$35$2967]}</span><span class='hs-varid'>repeat</span></a> <span class='hs-varid'>steps</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3063 : lq_tmp$x##3064:{lq_tmp$x##3047 : Int | lq_tmp$x##3047 &gt;= 0} -&gt; lq_tmp$x##3065:{lq_tmp$x##3048 : Int | lq_tmp$x##3048 &gt;= 0} -&gt; lq_tmp$x##3066:(List {lq_tmp$x##3050 : (List Double) | size lq_tmp$x##3050 == lq_tmp$x##3065}) -&gt; lq_tmp$x##3067:(Map {lq_tmp$x##3052 : Int | 0 &lt;= lq_tmp$x##3052
                                                                                                                                                                                                                                                                                              &amp;&amp; lq_tmp$x##3052 &lt; lq_tmp$x##3064} {lq_tmp$x##3054 : (List Double) | size lq_tmp$x##3054 == lq_tmp$x##3065}) -&gt; (Map {lq_tmp$x##3056 : Int | 0 &lt;= lq_tmp$x##3056
                                                                                                                                                                                                                                                                                                                                                                                                                                            &amp;&amp; lq_tmp$x##3056 &lt; lq_tmp$x##3064} {lq_tmp$x##3058 : (List Double) | size lq_tmp$x##3058 == lq_tmp$x##3065}) | lq_tmp$x##3063 == KMeans.kmeans1##r1L6}</span><span class='hs-varid'>kmeans1</span></a> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span> <span class='hs-varid'>ps</span><span class='hs-layout'>)</span>
<span class=hs-linenum>169: </span>
<span class=hs-linenum>170: </span><span class='hs-definition'>repeat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>171: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2966:{VV##2949 : Int^"lq_tmp$x##2951" | $k_$35$$35$2950} -&gt; lq_tmp$x##2967:(lq_tmp$x##2965:{VV##2953 : a^"lq_tmp$x##2955" | $k_$35$$35$2954[ds_d2rm:=lq_tmp$36$x$35$$35$2966]} -&gt; {VV##2956 : a^"lq_tmp$x##2958" | $k_$35$$35$2957[ds_d2rm:=lq_tmp$36$x$35$$35$2966][lq_tmp$36$x$35$$35$2952:=lq_tmp$36$x$35$$35$2965]}) -&gt; lq_tmp$x##2968:{VV##2959 : a^"lq_tmp$x##2961" | $k_$35$$35$2960[ds_d2rm:=lq_tmp$36$x$35$$35$2966][f$35$$35$a2l4:=lq_tmp$36$x$35$$35$2967]} -&gt; {VV##2962 : a^"lq_tmp$x##2964" | $k_$35$$35$2963[ds_d2rm:=lq_tmp$36$x$35$$35$2966][x$35$$35$a2l5:=lq_tmp$36$x$35$$35$2968][f$35$$35$a2l4:=lq_tmp$36$x$35$$35$2967]}</span><span class='hs-definition'>repeat</span></a> <span class='hs-num'>0</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2965:{VV : a^"lq_tmp$x##2955" | $k_$35$$35$2954[ds_d2rm:=ds_d2rm][VV$35$$35$2953:=VV][lq_tmp$36$x$35$$35$2966:=ds_d2rm]} -&gt; {VV : a^"lq_tmp$x##2958" | $k_$35$$35$2957[ds_d2rm:=ds_d2rm][lq_tmp$36$x$35$$35$2966:=ds_d2rm][lq_tmp$36$x$35$$35$2952:=lq_tmp$36$x$35$$35$2965][VV$35$$35$2956:=VV]}</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a^"lq_tmp$x##2961" | $k_$35$$35$2960[ds_d2rm:=ds_d2rm][lq_tmp$36$x$35$$35$2967:=f$35$$35$a2l4][lq_tmp$36$x$35$$35$2966:=ds_d2rm][VV$35$$35$2959:=VV][f$35$$35$a2l4:=f$35$$35$a2l4]}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>172: </span><span class='hs-definition'>repeat</span> <span class='hs-varid'>n</span> <span class='hs-varid'>f</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2966:{VV##2949 : Int^"lq_tmp$x##2951" | $k_$35$$35$2950} -&gt; lq_tmp$x##2967:(lq_tmp$x##2965:{VV##2953 : a^"lq_tmp$x##2955" | $k_$35$$35$2954[ds_d2rm:=lq_tmp$36$x$35$$35$2966]} -&gt; {VV##2956 : a^"lq_tmp$x##2958" | $k_$35$$35$2957[ds_d2rm:=lq_tmp$36$x$35$$35$2966][lq_tmp$36$x$35$$35$2952:=lq_tmp$36$x$35$$35$2965]}) -&gt; lq_tmp$x##2968:{VV##2959 : a^"lq_tmp$x##2961" | $k_$35$$35$2960[ds_d2rm:=lq_tmp$36$x$35$$35$2966][f$35$$35$a2l4:=lq_tmp$36$x$35$$35$2967]} -&gt; {VV##2962 : a^"lq_tmp$x##2964" | $k_$35$$35$2963[ds_d2rm:=lq_tmp$36$x$35$$35$2966][x$35$$35$a2l5:=lq_tmp$36$x$35$$35$2968][f$35$$35$a2l4:=lq_tmp$36$x$35$$35$2967]}</span><span class='hs-varid'>repeat</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3011 : Int^"lq_tmp$x##3010" | lq_tmp$x##3011 == ds_d2rm - lq_anf$##d2sv}</span><span class='hs-varid'>n</span></a><a class=annot href="#"><span class=annottext>lq_tmp$x##3008:Int -&gt; lq_tmp$x##3009:Int -&gt; {lq_tmp$x##3011 : Int^"lq_tmp$x##3010" | lq_tmp$x##3011 == lq_tmp$x##3008 - lq_tmp$x##3009}</span><span class='hs-comment'>-</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3033 : lq_tmp$x##3034:{VV : a^"lq_tmp$x##2955" | $k_$35$$35$2954[ds_d2rm:=ds_d2rm][VV$35$$35$2953:=VV][lq_tmp$36$x$35$$35$2966:=ds_d2rm]} -&gt; {VV : a^"lq_tmp$x##2958" | $k_$35$$35$2957[ds_d2rm:=ds_d2rm][lq_tmp$36$x$35$$35$2965:=lq_tmp$36$x$35$$35$3034][lq_tmp$36$x$35$$35$2966:=ds_d2rm][lq_tmp$36$x$35$$35$2952:=lq_tmp$36$x$35$$35$3034][VV$35$$35$2956:=VV]} | lq_tmp$x##3033 == f##a2l4}</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3017 : lq_tmp$x##3018:{VV : a^"lq_tmp$x##2955" | $k_$35$$35$2954[ds_d2rm:=ds_d2rm][VV$35$$35$2953:=VV][lq_tmp$36$x$35$$35$2966:=ds_d2rm]} -&gt; {VV : a^"lq_tmp$x##2958" | $k_$35$$35$2957[ds_d2rm:=ds_d2rm][lq_tmp$36$x$35$$35$2965:=lq_tmp$36$x$35$$35$3018][lq_tmp$36$x$35$$35$2966:=ds_d2rm][lq_tmp$36$x$35$$35$2952:=lq_tmp$36$x$35$$35$3018][VV$35$$35$2956:=VV]} | lq_tmp$x##3017 == f##a2l4}</span><span class='hs-varid'>f</span></a> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
</pre>\end{code}

In essence we start with an initial `k` centering, and repeatedly update it by calling
`kmeans1` which takes as input a list of `n` dimensional points, a centering and returns
a new centering (with `k` centers and `n` dimensional points). The new centers are computed by:

1. Mapping each point to its `nearest` center,
2. Grouping all the points mapped to a center into a new cluster,
3. Reducing the clusters by adding up all the points inside them, and
4. Normalizing each cluster to its `centroid`.

\begin{code}
<pre><span class=hs-linenum>185: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>kmeans1</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>k</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>186: </span>               <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>PointN</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>CenteringKN</span> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span>
<span class=hs-linenum>187: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>188: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2286:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##2287:{v##16 : Int | v##16 &gt;= 0} -&gt; lq_tmp$x##2288:(List {v##2 : (List Double) | size v##2 == lq_tmp$x##2287}) -&gt; lq_tmp$x##2289:(Map {v##0 : Int | 0 &lt;= v##0
                                                                                                                                                                                                          &amp;&amp; v##0 &lt; lq_tmp$x##2286} {v##2 : (List Double) | size v##2 == lq_tmp$x##2287}) -&gt; (Map {v##0 : Int | 0 &lt;= v##0
                                                                                                                                                                                                                                                                                                                &amp;&amp; v##0 &lt; lq_tmp$x##2286} {v##2 : (List Double) | size v##2 == lq_tmp$x##2287})</span><span class='hs-definition'>kmeans1</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>k</span></a> <a class=annot href="#"><span class=annottext>{v##16 : Int | v##16 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(List {v##2 : (List Double) | size v##2 == n##a2la})</span><span class='hs-varid'>ps</span></a> <a class=annot href="#"><span class=annottext>(Map {v##0 : Int | 0 &lt;= v##0
                   &amp;&amp; v##0 &lt; k##a2l9} {v##2 : (List Double) | size v##2 == n##a2la})</span><span class='hs-varid'>cs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2947 : (Map {lq_tmp$x##2939 : Int^"lq_tmp$x##2674" "lq_tmp$x##209" | $k_$35$$35$2673[VV$35$$35$2672:=lq_tmp$36$x$35$$35$2939][lq_tmp$36$x$35$$35$2652:=lq_tmp$36$x$35$$35$2947][lq_tmp$36$x$35$$35$2675:=lq_tmp$36$x$35$$35$2939][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]} {lq_tmp$x##2946 : ({lq_tmp$x##2940 : Int^"lq_tmp$x##2678" | $k_$35$$35$2677[lq_tmp$36$x$35$$35$2701:=lq_tmp$36$x$35$$35$2946][lq_tmp$36$x$35$$35$2652:=lq_tmp$36$x$35$$35$2947][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2946][lq_tmp$36$x$35$$35$2695:=lq_tmp$36$x$35$$35$2940][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2676:=lq_tmp$36$x$35$$35$2940][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]}, {lq_tmp$x##2942 : (List {lq_tmp$x##2941 : Double^"lq_tmp$x##2681" | $k_$35$$35$2680[VV$35$$35$2679:=lq_tmp$36$x$35$$35$2941][lq_tmp$36$x$35$$35$2696:=lq_tmp$36$x$35$$35$2941][lq_tmp$36$x$35$$35$2701:=lq_tmp$36$x$35$$35$2946][lq_tmp$36$x$35$$35$2697:=lq_tmp$36$x$35$$35$2942][lq_tmp$36$x$35$$35$2652:=lq_tmp$36$x$35$$35$2947][VV$35$$35$2682:=lq_tmp$36$x$35$$35$2942][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2946][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]})^"lq_tmp$x##2684" | $k_$35$$35$2683[lq_tmp$36$x$35$$35$2701:=lq_tmp$36$x$35$$35$2946][lq_tmp$36$x$35$$35$2697:=lq_tmp$36$x$35$$35$2942][lq_tmp$36$x$35$$35$2652:=lq_tmp$36$x$35$$35$2947][VV$35$$35$2682:=lq_tmp$36$x$35$$35$2942][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2946][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]})^"lq_tmp$x##2694" "lq_tmp$x##210" | $k_$35$$35$2693[lq_tmp$36$x$35$$35$2701:=lq_tmp$36$x$35$$35$2946][lq_tmp$36$x$35$$35$2652:=lq_tmp$36$x$35$$35$2947][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2946][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]})^"lq_tmp$x##211" | lq_tmp$x##2947 == newClusters##a2le}</span><span class='hs-varid'>normalize</span></a> <span class='hs-varid'>newClusters</span>
<span class=hs-linenum>189: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>190: </span>    <span class='hs-varid'>normalize</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Cluster</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>M</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Point</span>
<span class=hs-linenum>191: </span>    <a class=annot href="#"><span class=annottext>lq_tmp$x##2755:{VV##2778 : (Map {VV##2756 : a^"lq_tmp$x##2758" | $k_$35$$35$2757} {VV##2775 : ({VV##2759 : Int^"lq_tmp$x##2761" | $k_$35$$35$2760}, {VV##2765 : (List {VV##2762 : Double^"lq_tmp$x##2764" | $k_$35$$35$2763})^"lq_tmp$x##2767" | $k_$35$$35$2766})^"lq_tmp$x##2777" | $k_$35$$35$2776})^"lq_tmp$x##2780" | $k_$35$$35$2779} -&gt; {VV##2790 : (Map {VV##2781 : a^"lq_tmp$x##2783" | $k_$35$$35$2782} {VV##2787 : (List {VV##2784 : Double^"lq_tmp$x##2786" | $k_$35$$35$2785})^"lq_tmp$x##2789" | $k_$35$$35$2788})^"lq_tmp$x##2792" | $k_$35$$35$2791}</span><span class='hs-varid'>normalize</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>ds_d2rs:{VV##2809 : ({VV##2793 : Int^"lq_tmp$x##2795" | $k_$35$$35$2794}, {VV##2799 : (List {VV##2796 : Double^"lq_tmp$x##2798" | $k_$35$$35$2797})^"lq_tmp$x##2801" | $k_$35$$35$2800})^"lq_tmp$x##2811" | $k_$35$$35$2810} -&gt; {VV##2816 : (List {VV##2813 : Double^"lq_tmp$x##2815" | $k_$35$$35$2814})^"lq_tmp$x##2818" | $k_$35$$35$2817}</span><span class='hs-conid'>M</span></a><span class='hs-varop'>.</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2825 : ({lq_tmp$x##2819 : Int^"lq_tmp$x##2795" | $k_$35$$35$2794[VV$35$$35$2809:=lq_tmp$36$x$35$$35$2825][VV$35$$35$2793:=lq_tmp$36$x$35$$35$2819]}, {lq_tmp$x##2821 : (List {lq_tmp$x##2820 : Double^"lq_tmp$x##2798" | $k_$35$$35$2797[VV$35$$35$2809:=lq_tmp$36$x$35$$35$2825][VV$35$$35$2796:=lq_tmp$36$x$35$$35$2820][VV$35$$35$2799:=lq_tmp$36$x$35$$35$2821]})^"lq_tmp$x##2801" | $k_$35$$35$2800[VV$35$$35$2809:=lq_tmp$36$x$35$$35$2825][VV$35$$35$2799:=lq_tmp$36$x$35$$35$2821]})^"lq_tmp$x##2811" | lq_tmp$x##2825 == ds_d2rs}</span><span class='hs-keyglyph'>\</span></a><span class='hs-layout'>(</span><span class='hs-varid'>sz</span><span class='hs-layout'>,</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2856 : lq_tmp$x##2857:{lq_tmp$x##2848 : Int | lq_tmp$x##2848 &gt;= 0} -&gt; lq_tmp$x##2858:{lq_tmp$x##2850 : (List Double) | size lq_tmp$x##2850 == lq_tmp$x##2857} -&gt; lq_tmp$x##2859:{lq_tmp$x##2851 : Int | lq_tmp$x##2851 &gt;= 0
                                                                                                                                                                                                                   &amp;&amp; lq_tmp$x##2851 &gt; 0} -&gt; {lq_tmp$x##2853 : (List Double) | size lq_tmp$x##2853 == lq_tmp$x##2857} | lq_tmp$x##2856 == KMeans.centroid##r1L3}</span><span class='hs-varid'>centroid</span></a> <span class='hs-varid'>n</span> <span class='hs-varid'>p</span> <span class='hs-varid'>sz</span><span class='hs-layout'>)</span>
<span class=hs-linenum>192: </span>    <a class=annot href="#"><span class=annottext>(Map {lq_tmp$x##2675 : Int^"lq_tmp$x##2674" "lq_tmp$x##209" | $k_$35$$35$2673[VV$35$$35$2672:=lq_tmp$36$x$35$$35$2675][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]} {lq_tmp$x##2701 : ({lq_tmp$x##2695 : Int^"lq_tmp$x##2678" | $k_$35$$35$2677[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2676:=lq_tmp$36$x$35$$35$2695][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]}, {lq_tmp$x##2697 : (List {lq_tmp$x##2696 : Double^"lq_tmp$x##2681" | $k_$35$$35$2680[VV$35$$35$2679:=lq_tmp$36$x$35$$35$2696][VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]})^"lq_tmp$x##2684" | $k_$35$$35$2683[VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]})^"lq_tmp$x##2694" "lq_tmp$x##210" | $k_$35$$35$2693[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][lq_tmp$36$x$35$$35$2663:=ps$35$$35$a2lb][lq_tmp$36$x$35$$35$2661:=fm$35$$35$a2lf][lq_tmp$36$x$35$$35$2662:=fr$35$$35$a2lg]})</span><span class='hs-varid'>newClusters</span></a>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2661:(lq_tmp$x##2657:{lq_tmp$x##2671 : (List {lq_tmp$x##2670 : Double^"lq_tmp$x##2666" | $k_$35$$35$2665[VV$35$$35$2664:=lq_tmp$36$x$35$$35$2670][VV$35$$35$2667:=lq_tmp$36$x$35$$35$2671][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2669" "lq_tmp$x##194" | $k_$35$$35$2668[VV$35$$35$2667:=lq_tmp$36$x$35$$35$2671][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]} -&gt; (List ({lq_tmp$x##2675 : Int^"lq_tmp$x##2674" "lq_tmp$x##195" | $k_$35$$35$2673[VV$35$$35$2672:=lq_tmp$36$x$35$$35$2675][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]}, {lq_tmp$x##2701 : ({lq_tmp$x##2695 : Int^"lq_tmp$x##2678" | $k_$35$$35$2677[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2676:=lq_tmp$36$x$35$$35$2695]}, {lq_tmp$x##2697 : (List {lq_tmp$x##2696 : Double^"lq_tmp$x##2681" | $k_$35$$35$2680[VV$35$$35$2679:=lq_tmp$36$x$35$$35$2696][VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2684" | $k_$35$$35$2683[VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2694" "lq_tmp$x##196" | $k_$35$$35$2693[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]}))) -&gt; lq_tmp$x##2662:(lq_tmp$x##2658:{lq_tmp$x##2701 : ({lq_tmp$x##2695 : Int^"lq_tmp$x##2678" | $k_$35$$35$2677[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2676:=lq_tmp$36$x$35$$35$2695]}, {lq_tmp$x##2697 : (List {lq_tmp$x##2696 : Double^"lq_tmp$x##2681" | $k_$35$$35$2680[VV$35$$35$2679:=lq_tmp$36$x$35$$35$2696][VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2684" | $k_$35$$35$2683[VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2694" "lq_tmp$x##202" | $k_$35$$35$2693[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]} -&gt; lq_tmp$x##2659:{lq_tmp$x##2701 : ({lq_tmp$x##2695 : Int^"lq_tmp$x##2678" | $k_$35$$35$2677[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2676:=lq_tmp$36$x$35$$35$2695]}, {lq_tmp$x##2697 : (List {lq_tmp$x##2696 : Double^"lq_tmp$x##2681" | $k_$35$$35$2680[VV$35$$35$2679:=lq_tmp$36$x$35$$35$2696][VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2684" | $k_$35$$35$2683[VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2694" "lq_tmp$x##204" | $k_$35$$35$2693[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]} -&gt; {lq_tmp$x##2701 : ({lq_tmp$x##2695 : Int^"lq_tmp$x##2678" | $k_$35$$35$2677[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2676:=lq_tmp$36$x$35$$35$2695]}, {lq_tmp$x##2697 : (List {lq_tmp$x##2696 : Double^"lq_tmp$x##2681" | $k_$35$$35$2680[VV$35$$35$2679:=lq_tmp$36$x$35$$35$2696][VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2684" | $k_$35$$35$2683[VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2694" "lq_tmp$x##205" | $k_$35$$35$2693[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]}) -&gt; lq_tmp$x##2663:(List {lq_tmp$x##2671 : (List {lq_tmp$x##2670 : Double^"lq_tmp$x##2666" | $k_$35$$35$2665[VV$35$$35$2664:=lq_tmp$36$x$35$$35$2670][VV$35$$35$2667:=lq_tmp$36$x$35$$35$2671][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2669" "lq_tmp$x##207" | $k_$35$$35$2668[VV$35$$35$2667:=lq_tmp$36$x$35$$35$2671][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]}) -&gt; (Map {lq_tmp$x##2675 : Int^"lq_tmp$x##2674" "lq_tmp$x##209" | $k_$35$$35$2673[VV$35$$35$2672:=lq_tmp$36$x$35$$35$2675][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]} {lq_tmp$x##2701 : ({lq_tmp$x##2695 : Int^"lq_tmp$x##2678" | $k_$35$$35$2677[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS][VV$35$$35$2676:=lq_tmp$36$x$35$$35$2695]}, {lq_tmp$x##2697 : (List {lq_tmp$x##2696 : Double^"lq_tmp$x##2681" | $k_$35$$35$2680[VV$35$$35$2679:=lq_tmp$36$x$35$$35$2696][VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2684" | $k_$35$$35$2683[VV$35$$35$2682:=lq_tmp$36$x$35$$35$2697][VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})^"lq_tmp$x##2694" "lq_tmp$x##210" | $k_$35$$35$2693[VV$35$$35$2692:=lq_tmp$36$x$35$$35$2701][lq_tmp$36$x$35$$35$2660:=GHC.Classes.$36$fOrdInt$35$$35$rmS]})</span><span class='hs-varid'>mapReduce</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2724 : lq_tmp$x##2725:{lq_tmp$x##2705 : (List {lq_tmp$x##2704 : Double^"lq_tmp$x##2380" | $k_$35$$35$2379[VV$35$$35$2381:=lq_tmp$36$x$35$$35$2705][VV$35$$35$2378:=lq_tmp$36$x$35$$35$2704]})^"lq_tmp$x##2383" | $k_$35$$35$2382[VV$35$$35$2381:=lq_tmp$36$x$35$$35$2705]} -&gt; {lq_tmp$x##2723 : (List {lq_tmp$x##2722 : ({lq_tmp$x##2706 : Int^"lq_tmp$x##2387" | $k_$35$$35$2386[VV$35$$35$2385:=lq_tmp$36$x$35$$35$2706][VV$35$$35$2427:=lq_tmp$36$x$35$$35$2722][VV$35$$35$2430:=lq_tmp$36$x$35$$35$2723][p$35$$35$a2lk:=lq_tmp$36$x$35$$35$2725]}, {lq_tmp$x##2713 : ({lq_tmp$x##2707 : Int^"lq_tmp$x##2390" | $k_$35$$35$2389[VV$35$$35$2404:=lq_tmp$36$x$35$$35$2713][VV$35$$35$2388:=lq_tmp$36$x$35$$35$2707][VV$35$$35$2427:=lq_tmp$36$x$35$$35$2722][VV$35$$35$2430:=lq_tmp$36$x$35$$35$2723][p$35$$35$a2lk:=lq_tmp$36$x$35$$35$2725]}, {lq_tmp$x##2709 : (List {lq_tmp$x##2708 : Double^"lq_tmp$x##2393" | $k_$35$$35$2392[VV$35$$35$2404:=lq_tmp$36$x$35$$35$2713][VV$35$$35$2427:=lq_tmp$36$x$35$$35$2722][VV$35$$35$2430:=lq_tmp$36$x$35$$35$2723][VV$35$$35$2394:=lq_tmp$36$x$35$$35$2709][VV$35$$35$2391:=lq_tmp$36$x$35$$35$2708][p$35$$35$a2lk:=lq_tmp$36$x$35$$35$2725]})^"lq_tmp$x##2396" | $k_$35$$35$2395[VV$35$$35$2404:=lq_tmp$36$x$35$$35$2713][VV$35$$35$2427:=lq_tmp$36$x$35$$35$2722][VV$35$$35$2430:=lq_tmp$36$x$35$$35$2723][VV$35$$35$2394:=lq_tmp$36$x$35$$35$2709][p$35$$35$a2lk:=lq_tmp$36$x$35$$35$2725]})^"lq_tmp$x##2406" | $k_$35$$35$2405[VV$35$$35$2404:=lq_tmp$36$x$35$$35$2713][VV$35$$35$2427:=lq_tmp$36$x$35$$35$2722][VV$35$$35$2430:=lq_tmp$36$x$35$$35$2723][p$35$$35$a2lk:=lq_tmp$36$x$35$$35$2725]})^"lq_tmp$x##2429" | $k_$35$$35$2428[VV$35$$35$2427:=lq_tmp$36$x$35$$35$2722][VV$35$$35$2430:=lq_tmp$36$x$35$$35$2723][p$35$$35$a2lk:=lq_tmp$36$x$35$$35$2725]})^"lq_tmp$x##2432" | $k_$35$$35$2431[VV$35$$35$2430:=lq_tmp$36$x$35$$35$2723][p$35$$35$a2lk:=lq_tmp$36$x$35$$35$2725]} | lq_tmp$x##2724 == fm##a2lf}</span><span class='hs-varid'>fm</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2748 : lq_tmp$x##2749:{lq_tmp$x##2732 : ({lq_tmp$x##2726 : Int^"lq_tmp$x##2296" | $k_$35$$35$2295[VV$35$$35$2294:=lq_tmp$36$x$35$$35$2726][VV$35$$35$2310:=lq_tmp$36$x$35$$35$2732]}, {lq_tmp$x##2728 : (List {lq_tmp$x##2727 : Double^"lq_tmp$x##2299" | $k_$35$$35$2298[VV$35$$35$2297:=lq_tmp$36$x$35$$35$2727][VV$35$$35$2310:=lq_tmp$36$x$35$$35$2732][VV$35$$35$2300:=lq_tmp$36$x$35$$35$2728]})^"lq_tmp$x##2302" | $k_$35$$35$2301[VV$35$$35$2310:=lq_tmp$36$x$35$$35$2732][VV$35$$35$2300:=lq_tmp$36$x$35$$35$2728]})^"lq_tmp$x##2312" | $k_$35$$35$2311[VV$35$$35$2310:=lq_tmp$36$x$35$$35$2732]} -&gt; lq_tmp$x##2750:{lq_tmp$x##2739 : ({lq_tmp$x##2733 : Int^"lq_tmp$x##2316" | $k_$35$$35$2315[VV$35$$35$2330:=lq_tmp$36$x$35$$35$2739][wp1$35$$35$a2ll:=lq_tmp$36$x$35$$35$2749][VV$35$$35$2314:=lq_tmp$36$x$35$$35$2733]}, {lq_tmp$x##2735 : (List {lq_tmp$x##2734 : Double^"lq_tmp$x##2319" | $k_$35$$35$2318[VV$35$$35$2330:=lq_tmp$36$x$35$$35$2739][wp1$35$$35$a2ll:=lq_tmp$36$x$35$$35$2749][VV$35$$35$2317:=lq_tmp$36$x$35$$35$2734][VV$35$$35$2320:=lq_tmp$36$x$35$$35$2735]})^"lq_tmp$x##2322" | $k_$35$$35$2321[VV$35$$35$2330:=lq_tmp$36$x$35$$35$2739][wp1$35$$35$a2ll:=lq_tmp$36$x$35$$35$2749][VV$35$$35$2320:=lq_tmp$36$x$35$$35$2735]})^"lq_tmp$x##2332" | $k_$35$$35$2331[VV$35$$35$2330:=lq_tmp$36$x$35$$35$2739][wp1$35$$35$a2ll:=lq_tmp$36$x$35$$35$2749]} -&gt; ({lq_tmp$x##2740 : Int | lq_tmp$x##2740 &gt; 0}, {lq_tmp$x##2742 : (List Double) | size lq_tmp$x##2742 == n##a2la}) | lq_tmp$x##2748 == fr##a2lg}</span><span class='hs-varid'>fr</span></a> <span class='hs-varid'>ps</span>
<span class=hs-linenum>193: </span>    <a class=annot href="#"><span class=annottext>p##a2lk:{VV##2381 : (List {VV##2378 : Double^"lq_tmp$x##2380" | $k_$35$$35$2379})^"lq_tmp$x##2383" | $k_$35$$35$2382} -&gt; {VV##2430 : (List {VV##2427 : ({VV##2385 : Int^"lq_tmp$x##2387" | $k_$35$$35$2386}, {VV##2404 : ({VV##2388 : Int^"lq_tmp$x##2390" | $k_$35$$35$2389}, {VV##2394 : (List {VV##2391 : Double^"lq_tmp$x##2393" | $k_$35$$35$2392})^"lq_tmp$x##2396" | $k_$35$$35$2395})^"lq_tmp$x##2406" | $k_$35$$35$2405})^"lq_tmp$x##2429" | $k_$35$$35$2428})^"lq_tmp$x##2432" | $k_$35$$35$2431}</span><span class='hs-varid'>fm</span></a> <a class=annot href="#"><span class=annottext>{VV##2381 : (List {VV##2378 : Double^"lq_tmp$x##2380" | $k_$35$$35$2379})^"lq_tmp$x##2383" | $k_$35$$35$2382}</span><span class='hs-varid'>p</span></a>          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2496 : ({lq_tmp$x##2504 : Int^"lq_tmp$x##2503" | $k_$35$$35$2502[VV$35$$35$2501:=lq_tmp$36$x$35$$35$2504][lq_tmp$36$x$35$$35$2499:=lq_anf$36$$35$$35$d2sn][lq_tmp$36$x$35$$35$2500:=lq_anf$36$$35$$35$d2sp]}, {lq_tmp$x##2530 : ({lq_tmp$x##2524 : Int^"lq_tmp$x##2507" | $k_$35$$35$2506[lq_tmp$36$x$35$$35$2499:=lq_anf$36$$35$$35$d2sn][VV$35$$35$2521:=lq_tmp$36$x$35$$35$2530][VV$35$$35$2505:=lq_tmp$36$x$35$$35$2524][lq_tmp$36$x$35$$35$2500:=lq_anf$36$$35$$35$d2sp]}, {lq_tmp$x##2526 : (List {lq_tmp$x##2525 : Double^"lq_tmp$x##2510" | $k_$35$$35$2509[VV$35$$35$2511:=lq_tmp$36$x$35$$35$2526][VV$35$$35$2508:=lq_tmp$36$x$35$$35$2525][lq_tmp$36$x$35$$35$2499:=lq_anf$36$$35$$35$d2sn][VV$35$$35$2521:=lq_tmp$36$x$35$$35$2530][lq_tmp$36$x$35$$35$2500:=lq_anf$36$$35$$35$d2sp]})^"lq_tmp$x##2513" | $k_$35$$35$2512[VV$35$$35$2511:=lq_tmp$36$x$35$$35$2526][lq_tmp$36$x$35$$35$2499:=lq_anf$36$$35$$35$d2sn][VV$35$$35$2521:=lq_tmp$36$x$35$$35$2530][lq_tmp$36$x$35$$35$2500:=lq_anf$36$$35$$35$d2sp]})^"lq_tmp$x##2523" | $k_$35$$35$2522[lq_tmp$36$x$35$$35$2499:=lq_anf$36$$35$$35$d2sn][VV$35$$35$2521:=lq_tmp$36$x$35$$35$2530][lq_tmp$36$x$35$$35$2500:=lq_anf$36$$35$$35$d2sp]}) | snd lq_tmp$x##2496 == lq_anf$##d2sp
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         &amp;&amp; fst lq_tmp$x##2496 == lq_anf$##d2sn
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         &amp;&amp; x_Tuple22 lq_tmp$x##2496 == lq_anf$##d2sp
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         &amp;&amp; x_Tuple21 lq_tmp$x##2496 == lq_anf$##d2sn}</span><span class='hs-varid'>singleton</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##2445 : lq_tmp$x##2446:{lq_tmp$x##2433 : Int | lq_tmp$x##2433 &gt;= 0} -&gt; lq_tmp$x##2447:{lq_tmp$x##2434 : Int | lq_tmp$x##2434 &gt;= 0} -&gt; lq_tmp$x##2448:(Map {lq_tmp$x##2435 : Int | 0 &lt;= lq_tmp$x##2435
                                                                                                                                                                                            &amp;&amp; lq_tmp$x##2435 &lt; lq_tmp$x##2446} {lq_tmp$x##2437 : (List Double) | size lq_tmp$x##2437 == lq_tmp$x##2447}) -&gt; lq_tmp$x##2449:{lq_tmp$x##2440 : (List Double) | size lq_tmp$x##2440 == lq_tmp$x##2447} -&gt; {lq_tmp$x##2441 : Int | 0 &lt;= lq_tmp$x##2441
                                                                                                                                                                                                                                                                                                                                                                                                                                &amp;&amp; lq_tmp$x##2441 &lt; lq_tmp$x##2446} | lq_tmp$x##2445 == KMeans.nearest##r1KY}</span><span class='hs-varid'>nearest</span></a> <span class='hs-varid'>k</span> <span class='hs-varid'>n</span> <span class='hs-varid'>cs</span> <span class='hs-varid'>p</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-num'>1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-layout'>,</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>194: </span>    <a class=annot href="#"><span class=annottext>wp1##a2ll:{VV##2310 : ({VV##2294 : Int^"lq_tmp$x##2296" | $k_$35$$35$2295}, {VV##2300 : (List {VV##2297 : Double^"lq_tmp$x##2299" | $k_$35$$35$2298})^"lq_tmp$x##2302" | $k_$35$$35$2301})^"lq_tmp$x##2312" | $k_$35$$35$2311} -&gt; wp2##a2lm:{VV##2330 : ({VV##2314 : Int^"lq_tmp$x##2316" | $k_$35$$35$2315}, {VV##2320 : (List {VV##2317 : Double^"lq_tmp$x##2319" | $k_$35$$35$2318})^"lq_tmp$x##2322" | $k_$35$$35$2321})^"lq_tmp$x##2332" | $k_$35$$35$2331} -&gt; ({lq_tmp$x##2349 : Int | lq_tmp$x##2349 &gt; 0}, {lq_tmp$x##2351 : (List Double) | size lq_tmp$x##2351 == n##a2la})</span><span class='hs-varid'>fr</span></a> <a class=annot href="#"><span class=annottext>{VV##2310 : ({VV##2294 : Int^"lq_tmp$x##2296" | $k_$35$$35$2295}, {VV##2300 : (List {VV##2297 : Double^"lq_tmp$x##2299" | $k_$35$$35$2298})^"lq_tmp$x##2302" | $k_$35$$35$2301})^"lq_tmp$x##2312" | $k_$35$$35$2311}</span><span class='hs-varid'>wp1</span></a> <a class=annot href="#"><span class=annottext>{VV##2330 : ({VV##2314 : Int^"lq_tmp$x##2316" | $k_$35$$35$2315}, {VV##2320 : (List {VV##2317 : Double^"lq_tmp$x##2319" | $k_$35$$35$2318})^"lq_tmp$x##2322" | $k_$35$$35$2321})^"lq_tmp$x##2332" | $k_$35$$35$2331}</span><span class='hs-varid'>wp2</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2358 : lq_tmp$x##2359:{lq_tmp$x##2334 : Int | lq_tmp$x##2334 &gt;= 0} -&gt; lq_tmp$x##2360:({lq_tmp$x##2335 : Int | lq_tmp$x##2335 &gt; 0}, {lq_tmp$x##2337 : (List Double) | size lq_tmp$x##2337 == lq_tmp$x##2359}) -&gt; lq_tmp$x##2361:({lq_tmp$x##2342 : Int | lq_tmp$x##2342 &gt; 0}, {lq_tmp$x##2344 : (List Double) | size lq_tmp$x##2344 == lq_tmp$x##2359}) -&gt; ({lq_tmp$x##2349 : Int | lq_tmp$x##2349 &gt; 0}, {lq_tmp$x##2351 : (List Double) | size lq_tmp$x##2351 == lq_tmp$x##2359}) | lq_tmp$x##2358 == KMeans.mergeCluster##r1L2}</span><span class='hs-varid'>mergeCluster</span></a> <span class='hs-varid'>n</span> <span class='hs-varid'>wp1</span> <span class='hs-varid'>wp2</span>
</pre>\end{code}

Fix the code and specifications above so that LH verifies the the specification for `kmeans` and `kmeans1`
(i.e. verifies this entire module.)

**Hint:** If you did the above problems correctly, you should have to do nothing here.
Otherwise, think about what type `normalize` should have and try to work backwards
to verify that type.

</body>
</html>